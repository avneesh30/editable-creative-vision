import{jsx as e,jsxs as t,Fragment as a}from"react/jsx-runtime";import*as r from"react";import n,{useRef as i,useState as o,useEffect as l,useCallback as s,useMemo as c,createContext as d,useContext as u}from"react";import m from"react-dom/client";import*as f from"@radix-ui/react-tooltip";import{clsx as h}from"clsx";import{twMerge as p}from"tailwind-merge";import{fabric as g}from"fabric";import{saveAs as v}from"file-saver";import{toast as y}from"sonner";import{Slot as b}from"@radix-ui/react-slot";import{cva as x}from"class-variance-authority";import{PanelLeft as N,MousePointer as w,Type as S,Square as C,Circle as k,Image as z,Pencil as A,CheckSquare as T,X as F,Move3d as P,ZoomOut as j,ZoomIn as O,RotateCcw as R,Undo as E,Redo as L,Trash as W,Copy as U,Save as D,Download as I,PanelRight as M,Loader2 as B,Upload as J,Search as H,AlertCircle as q,Plus as V,RefreshCw as K,PlusSquare as G,Award as X,MessageSquare as Y,MessageCircle as _,ArrowRight as Z,ArrowLeft as Q,ArrowUp as $,ArrowDown as ee,MoreHorizontal as te,Pentagon as ae,Hexagon as re,Octagon as ne,Star as ie,Heart as oe,Grid3X3 as le,CircleIcon as se,Triangle as ce,ChevronRight as de,ChevronLeft as ue,SquareStack as me,Flag as fe,CreditCard as he,Mail as pe,Settings as ge,Move as ve,Layers as ye,Trash2 as be,Check as xe,ClipboardPaste as Ne,ArrowRightLeft as we,MoveUp as Se,MoveDown as Ce,Package as ke,PackageOpen as ze,Lock as Ae,Unlock as Te,EyeOff as Fe,Eye as Pe,FlipHorizontal as je,FlipVertical as Oe,Send as Re,ChevronDown as Ee,ChevronUp as Le,Minus as We,Bold as Ue,Italic as De,Underline as Ie,AlignLeft as Me,AlignCenter as Be,AlignRight as Je,AlignJustify as He,FileImage as qe,Code as Ve}from"lucide-react";import*as Ke from"@radix-ui/react-tabs";import*as Ge from"@radix-ui/react-scroll-area";import Xe from"psd.js";import*as Ye from"@radix-ui/react-slider";import*as _e from"@radix-ui/react-label";import{ChromePicker as Ze}from"react-color";import*as Qe from"@radix-ui/react-popover";import*as $e from"@radix-ui/react-separator";import et from"lodash.debounce";import*as tt from"@radix-ui/react-context-menu";import*as at from"@radix-ui/react-select";import*as rt from"@radix-ui/react-dialog";import*as nt from"@radix-ui/react-toast";var it=function(){return it=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},it.apply(this,arguments)};function ot(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(a[r[n]]=e[r[n]])}return a}function lt(e,t,a,r){return new(a||(a=Promise))((function(n,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}s((r=r.apply(e,t||[])).next())}))}function st(e,t){var a,r,n,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(a=1,r&&(n=2&l[0]?r.return:l[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,l[1])).done)return n;switch(r=0,n&&(l=[2&l[0],n.value]),l[0]){case 0:case 1:n=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!n||l[1]>n[0]&&l[1]<n[3])){i.label=l[1];break}if(6===l[0]&&i.label<n[1]){i.label=n[1],n=l;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(l);break}n[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{a=n=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}}function ct(e,t,a){if(a||2===arguments.length)for(var r,n=0,i=t.length;n<i;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))}function dt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return p(h(e))}"function"==typeof SuppressedError&&SuppressedError;var ut=f.Provider,mt=f.Root,ft=f.Trigger,ht=r.forwardRef((function(t,a){var r=t.className,n=t.sideOffset,i=void 0===n?4:n,o=ot(t,["className","sideOffset"]);return e(f.Content,it({ref:a,sideOffset:i,className:dt("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r)},o))}));ht.displayName=f.Content.displayName;var pt=function(e){if("text"===e.type||"i-text"===e.type||"textbox"===e.type){var t=e;t.fontFamily||(t.set("fontFamily","Arial"),console.log("Fixed missing fontFamily")),t.fontSize&&!isNaN(t.fontSize)||(t.set("fontSize",20),console.log("Fixed missing or invalid fontSize")),t.fontStyle&&["","normal","italic","oblique"].includes(t.fontStyle)||(t.set("fontStyle","normal"),console.log("Fixed invalid fontStyle")),void 0!==t.fontWeight&&null!==t.fontWeight||(t.set("fontWeight","normal"),console.log("Fixed missing fontWeight")),void 0!==t.textAlign&&null!==t.textAlign||(t.set("textAlign","left"),console.log("Fixed missing textAlign")),void 0===t.underline&&t.set("underline",!1),void 0===t.backgroundColor&&t.set("backgroundColor",""),(void 0===t.lineHeight||isNaN(t.lineHeight))&&t.set("lineHeight",1.16),t._forceClearCache=!0}},gt=function(e,t,a){return{initCanvas:s((function(r){if(r){var n=new g.Canvas(r,{backgroundColor:"#ffffff",width:e.width,height:e.height,preserveObjectStacking:!0,skipOffscreen:!0});return n.on("selection:created",(function(e){var a,r=(null===(a=e.selected)||void 0===a?void 0:a[0])||null;if(r)try{pt(r),console.log("Fixed properties on selection:created")}catch(e){console.error("Error fixing properties on selection:created",e)}t(r)})),n.on("selection:updated",(function(e){var a,r=(null===(a=e.selected)||void 0===a?void 0:a[0])||null;if(r)try{pt(r),console.log("Fixed properties on selection:updated")}catch(e){console.error("Error fixing properties on selection:updated",e)}t(r)})),n.on("selection:cleared",(function(){t(null)})),n.on("object:modified",(function(e){if(e.target)try{pt(e.target),console.log("Fixed properties on object:modified")}catch(e){console.error("Error fixing properties on object:modified",e)}a()})),n.on("object:added",(function(e){if(e.target)try{pt(e.target),console.log("Fixed properties on object:added")}catch(e){console.error("Error fixing properties on object:added",e)}})),setTimeout((function(){try{!function(e){if(e)try{e.getObjects().forEach((function(e){try{pt(e)}catch(e){console.error("Error fixing text object:",e)}}))}catch(e){console.error("Error in fixAllTextObjectsSafely:",e)}}(n),n.requestRenderAll()}catch(e){console.error("Error in initial text fix:",e)}}),100),n}}),[e,t,a])}},vt=function(e,t){for(var a=[],r=2*Math.PI/e,n=0;n<e;n++){var i=n*r-Math.PI/2;a.push({x:t*Math.cos(i),y:t*Math.sin(i)})}return a},yt=function(e){if(!e)return e;try{e.fontFamily||(e.set("fontFamily","Arial"),console.log("Fixed missing fontFamily in helper")),e.fontSize&&!isNaN(e.fontSize)||(e.set("fontSize",20),console.log("Fixed missing or invalid fontSize in helper")),e.fontStyle&&["","normal","italic","oblique"].includes(e.fontStyle)||(e.set("fontStyle","normal"),console.log("Fixed invalid fontStyle in helper")),void 0!==e.fontWeight&&null!==e.fontWeight||(e.set("fontWeight","normal"),console.log("Fixed missing fontWeight in helper")),void 0!==e.textAlign&&null!==e.textAlign||(e.set("textAlign","left"),console.log("Fixed missing textAlign in helper")),void 0!==e.fill&&null!==e.fill||e.set("fill","#000000"),e._forceClearCache=!0}catch(e){console.error("Error in ensureValidTextProperties:",e)}return e},bt=function(e,t,a){return{addText:function(r,n){if(void 0===n&&(n={}),e)try{var i=it({},n),o=it({left:100,top:100,fontFamily:"Arial",fontSize:20,fontWeight:"normal",fontStyle:"normal",textAlign:"left",fill:"#000000"},i);o.fontFamily||(o.fontFamily="Arial"),o.fontSize&&!isNaN(o.fontSize)||(o.fontSize=20),o.fill||(o.fill="#000000"),o.fontStyle&&["","normal","italic","oblique"].includes(o.fontStyle)||(o.fontStyle="normal");var l=new g.IText(r||"Text",o);yt(l),console.log("Text object created with properties:",{fontFamily:l.fontFamily,fontSize:l.fontSize,fontWeight:l.fontWeight,fontStyle:l.fontStyle,textAlign:l.textAlign,fill:l.fill}),e.add(l),e.setActiveObject(l),t(l),l.textAlign&&(l.set("textAlign",l.textAlign),e.requestRenderAll()),e.renderAll(),a()}catch(e){console.error("Error creating text object:",e)}},addRect:function(r){if(void 0===r&&(r={}),e)try{var n=new g.Rect(it({left:100,top:100,width:r.width||100,height:r.height||100,fill:r.fill||"#1e88e5",stroke:r.stroke||void 0,strokeWidth:r.strokeWidth||0,rx:r.rx||0,ry:r.ry||0,selectable:!0,hasControls:!0,hasBorders:!0},r));console.log("Created rectangle with properties:",{left:n.left,top:n.top,width:n.width,height:n.height,fill:n.fill,selectable:n.selectable}),e.add(n),e.setActiveObject(n),t(n),e.renderAll(),a()}catch(e){console.error("Error creating rectangle:",e)}},addCircle:function(r){if(void 0===r&&(r={}),e)try{var n=new g.Circle(it({left:100,top:100,radius:r.radius||50,fill:r.fill||"#4caf50",stroke:r.stroke||void 0,strokeWidth:r.strokeWidth||0,selectable:!0,hasControls:!0,hasBorders:!0},r));console.log("Created circle with properties:",{left:n.left,top:n.top,radius:n.radius,fill:n.fill,selectable:n.selectable}),e.add(n),e.setActiveObject(n),t(n),e.renderAll(),a()}catch(e){console.error("Error creating circle:",e)}},addTriangle:function(r){if(void 0===r&&(r={}),e)try{var n=new g.Triangle(it({left:100,top:100,width:r.width||100,height:r.height||100,fill:r.fill||"#ff9800",stroke:r.stroke||void 0,strokeWidth:r.strokeWidth||0,selectable:!0,hasControls:!0,hasBorders:!0},r));console.log("Created triangle with properties:",{left:n.left,top:n.top,width:n.width,height:n.height,fill:n.fill,selectable:n.selectable}),e.add(n),e.setActiveObject(n),t(n),e.renderAll(),a()}catch(e){console.error("Error creating triangle:",e)}},addImage:function(r,n){void 0===n&&(n={}),e&&g.Image.fromURL(r,(function(r){try{if(r.width&&r.height&&(r.width>300||r.height>300)){var i=300/r.width,o=300/r.height,l=Math.min(i,o);r.scale(l)}r.set(it({left:100,top:100,selectable:!0,hasControls:!0,hasBorders:!0},n)),console.log("Created image with properties:",{left:r.left,top:r.top,width:r.width,height:r.height,selectable:r.selectable}),e.add(r),e.setActiveObject(r),t(r),e.renderAll(),a()}catch(e){console.error("Error processing image:",e)}}),{crossOrigin:"anonymous"})},addShape:function(t,a){if(void 0===a&&(a={}),e){var r,n="#4CAF50",i="#000000";switch(t){case"rect":case"square":default:r=new g.Rect({left:100,top:100,width:100,height:100,fill:n,stroke:i,strokeWidth:1});break;case"circle":r=new g.Circle({left:100,top:100,radius:50,fill:n,stroke:i,strokeWidth:1});break;case"triangle":r=new g.Triangle({left:100,top:100,width:100,height:100,fill:n,stroke:i,strokeWidth:1});break;case"diamond":r=new g.Rect({left:100,top:100,width:100,height:100,fill:n,stroke:i,strokeWidth:1,angle:45});break;case"ellipse":r=new g.Ellipse({left:100,top:100,rx:60,ry:40,fill:n,stroke:i,strokeWidth:1});break;case"pentagon":var o=vt(5,50);r=new g.Polygon(o,{left:100,top:100,fill:n,stroke:i,strokeWidth:1});break;case"hexagon":var l=vt(6,50);r=new g.Polygon(l,{left:100,top:100,fill:n,stroke:i,strokeWidth:1});break;case"octagon":var s=vt(8,50);r=new g.Polygon(s,{left:100,top:100,fill:n,stroke:i,strokeWidth:1});break;case"star":var c=function(e,t,a){for(var r=[],n=Math.PI/e,i=0;i<2*e;i++){var o=i*n-Math.PI/2,l=i%2==0?t:a;r.push({x:l*Math.cos(o),y:l*Math.sin(o)})}return r}(5,50,25);r=new g.Polygon(c,{left:100,top:100,fill:n,stroke:i,strokeWidth:1});break;case"heart":r=new g.Path("M 25,45 A 14,14 0,0,1 0,30 A 14,14 0,0,1 25,15 A 14,14 0,0,1 50,30 A 14,14 0,0,1 25,45 z",{left:100,top:100,fill:n,stroke:i,strokeWidth:1,scaleX:2,scaleY:2});break;case"arrow":var d=void 0;switch(a.direction||"right"){case"right":default:d="M 0,20 L 80,20 L 80,10 L 100,25 L 80,40 L 80,30 L 0,30 z";break;case"left":d="M 100,20 L 20,20 L 20,10 L 0,25 L 20,40 L 20,30 L 100,30 z";break;case"up":d="M 25,100 L 25,20 L 10,20 L 25,0 L 40,20 L 30,20 L 30,100 z";break;case"down":d="M 25,0 L 25,80 L 10,80 L 25,100 L 40,80 L 30,80 L 30,0 z"}r=new g.Path(d,{left:100,top:100,fill:n,stroke:i,strokeWidth:1});break;case"callout":var u=void 0;u="circle"===(a.type||"square")?"M 50,0 A 50,50 0 1,0 50,100 A 50,50 0 1,0 50,0 M 30,100 L 25,120 L 60,95":"M 0,0 L 100,0 L 100,80 L 70,80 L 50,100 L 50,80 L 0,80 z",r=new g.Path(u,{left:100,top:100,fill:n,stroke:i,strokeWidth:1});break;case"plus":r=new g.Path("M 40,0 L 60,0 L 60,40 L 100,40 L 100,60 L 60,60 L 60,100 L 40,100 L 40,60 L 0,60 L 0,40 L 40,40 z",{left:100,top:100,fill:n,stroke:i,strokeWidth:1});break;case"badge":r=new g.Path("M 50,0 L 61,35 L 98,35 L 68,57 L 79,91 L 50,70 L 21,91 L 32,57 L 2,35 L 39,35 z",{left:100,top:100,fill:n,stroke:i,strokeWidth:1});break;case"grid":for(var m=100,f=[],h=0;h<=m;h+=20)f.push(new g.Line([0,h,m,h],{stroke:i,strokeWidth:1}));for(h=0;h<=m;h+=20)f.push(new g.Line([h,0,h,m],{stroke:i,strokeWidth:1}));r=new g.Group(f,{left:100,top:100})}return e.add(r),e.setActiveObject(r),e.requestRenderAll(),e.fire("object:added",{target:r}),r}},createBusinessCardTemplate:function(){if(e)try{e.clear(),e.setBackgroundColor("#ffffff",e.renderAll.bind(e));!function(){try{var t=new g.IText("Juliana Silva",{left:500,top:190,fontFamily:"Arial",fontSize:60,fill:"#333333",originX:"center",fontWeight:"normal",fontStyle:"normal",textAlign:"center",selectable:!0,hasControls:!0,hasBorders:!0});yt(t),e.add(t);var r=new g.IText("123-456-7890",{left:550,top:320,fontFamily:"Arial",fontSize:20,fill:"#333333",fontWeight:"normal",fontStyle:"normal",textAlign:"left",selectable:!0,hasControls:!0,hasBorders:!0});yt(r);var n=new g.Text("",{left:510,top:323,fontFamily:"Arial",fontSize:24,fill:"#333333",text:"ï‚•",fontWeight:"normal",fontStyle:"normal",textAlign:"left",selectable:!0,hasControls:!0,hasBorders:!0});yt(n),e.add(r),e.add(n);var i=new g.Circle({radius:80,fill:"#e0e0e0",left:100,top:100,originX:"center",originY:"center",selectable:!0,hasControls:!0,hasBorders:!0}),o=new g.IText("Photo",{left:100,top:100,fontFamily:"Arial",fontSize:16,fill:"#666666",originX:"center",originY:"center",fontWeight:"normal",fontStyle:"normal",textAlign:"center",selectable:!0,hasControls:!0,hasBorders:!0});yt(o),e.add(i,o),e.renderAll(),a()}catch(e){console.error("Error creating business card elements:",e)}}()}catch(e){console.error("Error in createBusinessCardTemplate:",e)}}}},xt=800,Nt=600,wt=function(t){var a=t.children,r=t.initialWidth,n=t.initialHeight,d=t.initialTemplate,u={width:r||xt,height:n||Nt},m=o(null),f=m[0],h=m[1],p=o(null),b=p[0],x=p[1],N=function(){var e=i([]),t=i([]),a=o(!1),r=a[0],n=a[1],s=o(!1),c=s[0],d=s[1];return l((function(){n(e.current.length>1),d(t.current.length>0)}),[e.current.length,t.current.length]),{saveToHistory:function(a){if(a)try{var r=JSON.stringify(a.toJSON(["id","selectable","hasControls","hasBorders"]));e.current.push(r),t.current=[],e.current.length>50&&e.current.shift(),n(e.current.length>1),d(!1),console.log("Saved to history, undo stack length:",e.current.length)}catch(e){console.error("Error saving canvas state to history:",e)}},undo:function(a){if(a&&!(e.current.length<=1))try{var r=e.current.pop()||"";t.current.push(r);var i=e.current[e.current.length-1];i&&a.loadFromJSON(JSON.parse(i),(function(){a.renderAll(),console.log("Undo: Loaded previous state from history")})),n(e.current.length>1),d(t.current.length>0)}catch(e){console.error("Error in undo operation:",e)}},redo:function(a){if(a&&0!==t.current.length)try{var r=t.current.pop();r&&(e.current.length,a.loadFromJSON(JSON.parse(r),(function(){a.renderAll(),console.log("Redo: Loaded next state from history"),e.current.push(r)}))),n(!0),d(t.current.length>0)}catch(e){console.error("Error in redo operation:",e)}},canUndo:r,canRedo:c}}(),w=N.saveToHistory,S=N.undo,C=N.redo,k=N.canUndo,z=N.canRedo,A=function(e){var t=o(!1),a=t[0],r=t[1],n=s((function(){e&&(r(!0),e.defaultCursor="grab",e.getObjects().forEach((function(e){e.selectable=!1,e.evented=!1})),e.selection=!1,e.renderAll(),e.on("mouse:down",(function(t){var r=t.e;a&&(this.isDragging=!0,this.selection=!1,this.lastPosX=r.clientX,this.lastPosY=r.clientY,e.defaultCursor="grabbing")})),e.on("mouse:move",(function(e){if(this.isDragging&&a){var t=e.e,r=this.viewportTransform;r&&void 0!==this.lastPosX&&void 0!==this.lastPosY&&(r[4]+=t.clientX-this.lastPosX,r[5]+=t.clientY-this.lastPosY,this.requestRenderAll(),this.lastPosX=t.clientX,this.lastPosY=t.clientY)}})),e.on("mouse:up",(function(){this.isDragging=!1,this.selection=!0,e.defaultCursor="grab"})))}),[e,a]),i=s((function(){e&&(r(!1),e.defaultCursor="default",e.getObjects().forEach((function(e){e.selectable=!0,e.evented=!0})),e.selection=!0,e.off("mouse:down"),e.off("mouse:move"),e.off("mouse:up"),e.renderAll())}),[e]);return{isPanEnabled:a,enablePan:n,disablePan:i}}(f),T=A.isPanEnabled,F=A.enablePan,P=A.disablePan,j=function(e){return{setCursor:s((function(t){e&&(e.defaultCursor=t)}),[e])}}(f).setCursor,O=function(e,t){var a=o("#ffffff"),r=a[0],n=a[1];return{canvasBackgroundColor:r,setCanvasBackgroundColor:s((function(a){e&&(e.backgroundColor=a,n(a),e.renderAll(),t())}),[e,t])}}(f,(function(){return w(f)})),R=O.canvasBackgroundColor,E=O.setCanvasBackgroundColor,L=function(e,t,a,r){var n=o("select"),i=n[0],s=n[1];return l((function(){if(e)switch(a&&"select"!==i&&r(),e.isDrawingMode="draw"===i,"draw"===i&&(e.freeDrawingBrush.width=2,e.freeDrawingBrush.color="#000000"),i){case"select":default:t("default");break;case"draw":case"shape":t("crosshair");break;case"text":t("text");break;case"image":t("cell")}}),[i,e,a,r,t]),{mode:i,setMode:s}}(f,j,T,P),W=L.mode,U=L.setMode,D=function(e,t,a){var r=o(t),n=r[0],i=r[1];return{canvasSize:n,setCanvasSize:s((function(t){e&&(i(t),e.setWidth(t.width),e.setHeight(t.height),e.renderAll(),a())}),[e,a])}}(f,u,(function(){return w(f)})),I=D.canvasSize,M=D.setCanvasSize;!function(e,t){l((function(){if(e){var a=function(){console.log("Object modified - saving to history"),t(e)},r=function(){console.log("Object added - saving to history"),t(e)},n=function(){console.log("Object removed - saving to history"),t(e)};return e.on("object:modified",a),e.on("object:added",r),e.on("object:removed",n),t(e),function(){e.off("object:modified",a),e.off("object:added",r),e.off("object:removed",n)}}}),[e,t])}(f,w);var B=gt(I,x,(function(){return w(f)})).initCanvas,J=s((function(e){if(e){var t=B(e);return t?(h(t),t):void 0}}),[B]);l((function(){if(f&&d)try{f.loadFromJSON(JSON.parse(d),(function(){f.renderAll(),w(f)}))}catch(e){console.error("Failed to load initial template:",e)}}),[f,d,w]);var H=bt(f,x,(function(){return w(f)})),q=H.addText,V=H.addRect,K=H.addCircle,G=H.addTriangle,X=H.addImage,Y=H.addShape,_=H.createBusinessCardTemplate,Z=function(e,t,a){return{removeActiveObject:function(){if(e&&e.getActiveObject()){var r=e.getActiveObject();if(r instanceof g.ActiveSelection)r.getObjects().forEach((function(t){e.remove(t)})),e.discardActiveObject();else{var n=e.getActiveObject();n&&e.remove(n)}t(null),e.renderAll(),a()}},bringForward:function(){if(e){var t=e.getActiveObject();t&&(e.bringForward(t),e.renderAll(),a())}},sendBackward:function(){if(e){var t=e.getActiveObject();t&&(e.sendBackwards(t),e.renderAll(),a())}},bringToFront:function(){if(e){var t=e.getActiveObject();t&&(e.bringToFront(t),e.renderAll(),a())}},sendToBack:function(){if(e){var t=e.getActiveObject();t&&(e.sendToBack(t),e.renderAll(),a())}},groupSelected:function(){if(e&&e.getActiveObject()){var t=e.getActiveObject();if(t&&t.type&&"activeSelection"===t.type){var r=t.toGroup();e.setActiveObject(r),a()}}},ungroupSelected:function(){if(e&&e.getActiveObject()){var t=e.getActiveObject();if(t&&t.type&&"group"===t.type){var r=t.toActiveSelection();e.setActiveObject(r),e.requestRenderAll(),a()}}},cloneSelected:function(){if(e&&e.getActiveObject()){var r=e.getActiveObject();r&&r.clone((function(r){r.set({left:(r.left||0)+20,top:(r.top||0)+20}),e.add(r),e.setActiveObject(r),t(r),a()}))}},selectAll:function(){if(e){var a=e.getObjects();if(0!==a.length){if(1===a.length)e.setActiveObject(a[0]);else{var r=new g.ActiveSelection(a,{canvas:e});e.setActiveObject(r)}e.requestRenderAll(),t(e.getActiveObject())}}},clearCanvas:function(){e&&(e.clear(),e.backgroundColor="#ffffff",e.requestRenderAll(),t(null),a())}}}(f,x,(function(){return w(f)})),Q=Z.removeActiveObject,$=Z.bringForward,ee=Z.sendBackward,te=Z.bringToFront,ae=Z.sendToBack,re=Z.groupSelected,ne=Z.ungroupSelected,ie=Z.cloneSelected,oe=Z.selectAll,le=Z.clearCanvas,se=function(e){return{saveToJSON:function(){return e?JSON.stringify(e.toJSON(["id","name"])):""},loadFromJSON:function(t){if(e)try{e.loadFromJSON(JSON.parse(t),(function(){e.renderAll()}))}catch(e){console.error("Error loading from JSON:",e)}},exportToImage:function(t){for(var a=[],r=1;r<arguments.length;r++)a[r-1]=arguments[r];return lt(void 0,ct([t],a,!0),void 0,(function(t,a){var r,n,i;return void 0===a&&(a="normal"),st(this,(function(o){return e?"svg"===t?(r=e.toSVG(),[2,"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(r))]):(n="high"===a?2:1,i="jpeg"===t?.92:1,[2,e.toDataURL({format:"jpeg"===t?"jpeg":"png",quality:i,multiplier:n})]):[2,""]}))}))},exportToHTML:function(){if(!e)return"";var t=e.toSVG();return'<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8">\n  <title>Exported Design</title>\n  <style>\n    body { margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }\n    .canvas-container { box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1); }\n  </style>\n</head>\n<body>\n  <div class="canvas-container">\n    '.concat(t,"\n  </div>\n</body>\n</html>")},downloadImage:function(t,a){if(void 0===a&&(a="normal"),e)if("svg"!==t){var r="high"===a?2:1,n="jpeg"===t?.92:1,i=e.toDataURL({format:"jpeg"===t?"jpeg":"png",quality:n,multiplier:r}),o=document.createElement("a");o.href=i,o.download="design.".concat(t),document.body.appendChild(o),o.click(),document.body.removeChild(o)}else{var l=e.toSVG(),s=new Blob([l],{type:"image/svg+xml"});v(s,"design.svg")}},createTemplateFromImage:function(t,a){return e?{thumbnailUrl:e.toDataURL({format:"jpeg",quality:.7,multiplier:.5}),canvasJson:JSON.stringify(e.toJSON(["id","name"])),size:{width:e.width||800,height:e.height||600}}:{thumbnailUrl:"",canvasJson:"",size:{width:0,height:0}}}}}(f),ce=se.saveToJSON,de=se.loadFromJSON,ue=se.exportToImage,me=se.exportToHTML,fe=se.downloadImage,he=function(e,t){var a=o(1),r=a[0],n=a[1];l((function(){e&&(e.setDimensions({width:t.width,height:t.height}),e.renderAll())}),[e,t]);var i=s((function(a){e&&(e.setZoom(a),e.setDimensions({width:t.width*a,height:t.height*a}),e.renderAll())}),[e,t]),c=s((function(){if(e){var t=Math.min(r+.1,3);n(t),i(t)}}),[e,r,i]),d=s((function(){if(e){var t=Math.max(r-.1,.1);n(t),i(t)}}),[e,r,i]),u=s((function(){e&&(n(1),i(1))}),[e,i]);return{zoom:r,zoomIn:c,zoomOut:d,resetZoom:u}}(f,I),pe=he.zoom,ge=he.zoomIn,ve=he.zoomOut,ye=he.resetZoom,be=function(e,t){var a=o(null),r=a[0],n=a[1];return{copyToClipboard:function(){if(e){var t=e.getActiveObject();t?t.clone((function(e){n(JSON.stringify(e.toJSON())),y.success("Copied to clipboard")}),["data"]):y.error("No object selected to copy")}},pasteFromClipboard:function(){if(e&&r)try{var a=e.getActiveObject();a?g.util.enlivenObjects([JSON.parse(r)],(function(r){if(r.length>0){var n=r[0];n.set({left:a.left,top:a.top,scaleX:a.scaleX,scaleY:a.scaleY,angle:a.angle}),e.remove(a),e.add(n),e.setActiveObject(n),e.renderAll(),t(),y.success("Object replaced")}}),"fabric"):g.util.enlivenObjects([JSON.parse(r)],(function(a){if(a.length>0){var r=a[0];r.set({left:(r.left||0)+20,top:(r.top||0)+20}),e.add(r),e.setActiveObject(r),e.renderAll(),t(),y.success("Pasted from clipboard")}}),"fabric")}catch(e){console.error("Error pasting from clipboard:",e),y.error("Error pasting from clipboard")}else r||y.error("Nothing to paste")},pasteAtPosition:function(a,n){if(e&&r)try{g.util.enlivenObjects([JSON.parse(r)],(function(r){if(r.length>0){var i=r[0];i.set({left:a-(i.width||0)*(i.scaleX||1)/2,top:n-(i.height||0)*(i.scaleY||1)/2}),e.add(i),e.setActiveObject(i),e.renderAll(),t(),y.success("Pasted from clipboard")}}),"fabric")}catch(e){console.error("Error pasting from clipboard:",e),y.error("Error pasting from clipboard")}else r||y.error("Nothing to paste")}}}(f,(function(){return w(f)})),xe=be.copyToClipboard,Ne=be.pasteFromClipboard,we=be.pasteAtPosition,Se=s((function(){console.log("Undo triggered in Editor Provider"),S(f)}),[S,f]),Ce=s((function(){console.log("Redo triggered in Editor Provider"),C(f)}),[C,f]),ke=c((function(){return{canvas:f,activeObject:b,mode:W,setMode:U,canvasSize:I,setCanvasSize:M,canvasBackgroundColor:R,setCanvasBackgroundColor:E,initCanvas:J,addText:q,addRect:V,addCircle:K,addImage:X,addTriangle:G,removeActiveObject:Q,bringForward:$,sendBackward:ee,bringToFront:te,sendToBack:ae,groupSelected:re,ungroupSelected:ne,cloneSelected:ie,saveToJSON:ce,loadFromJSON:de,exportToImage:ue,exportToHTML:me,zoomIn:ge,zoomOut:ve,resetZoom:ye,undo:Se,redo:Ce,downloadImage:fe,copyToClipboard:xe,pasteFromClipboard:Ne,pasteAtPosition:we,setCursor:j,zoom:pe,createBusinessCardTemplate:_,selectAll:oe,clearCanvas:le,saveToHistory:w,canUndo:k,canRedo:z,addShape:Y,enablePan:F,disablePan:P,isPanEnabled:T}}),[f,b,W,I,J,q,V,K,X,G,Q,$,ee,te,ae,re,ne,ie,ce,de,ue,me,ge,ve,ye,Se,Ce,fe,xe,Ne,we,pe,_,oe,le,M,w,k,z,Y,R,E,F,P,T,j]);return e(St.Provider,{value:ke,children:a})},St=d(null),Ct=function(){var e=u(St);if(!e)throw new Error("useEditor must be used within an EditorProvider");return e},kt=function(t){var a=t.children,r=t.initialWidth,n=t.initialHeight,i=t.initialTemplate;return e(wt,{initialWidth:r,initialHeight:n,initialTemplate:i,children:a})},zt=x("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),At=r.forwardRef((function(t,a){var r=t.className,n=t.variant,i=t.size,o=t.asChild,l=void 0!==o&&o,s=ot(t,["className","variant","size","asChild"]);return e(l?b:"button",it({className:dt(zt({variant:n,size:i,className:r})),ref:a},s))}));At.displayName="Button";var Tt=function(a){var r=a.onExport,n=a.onSave,i=a.onUndo,o=a.onRedo,l=a.onZoomIn,s=a.onZoomOut,c=a.onResetZoom,d=a.toggleLeftSidebar,u=a.toggleRightSidebar,m=a.zoom;a.onSelectAll,a.onClearCanvas;var f=a.onResizeCanvas,h=Ct(),p=h.mode,g=h.setMode,v=h.addText,y=h.addRect,b=h.addCircle,x=h.removeActiveObject,B=h.selectAll,J=h.clearCanvas;h.canvas;return e("div",{className:"editor-toolbar",children:t(ut,{children:[t("div",{className:"flex items-center gap-2",children:[t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"ghost",size:"icon",onClick:d,className:"h-9 w-9",children:e(N,{className:"h-5 w-5"})})}),e(ht,{children:"Toggle Sidebar"})]}),e("div",{className:"bg-secondary h-6 w-px mx-1"}),t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"select"===p?"default":"ghost",size:"icon",onClick:function(){return g("select")},className:"h-9 w-9",children:e(w,{className:"h-5 w-5"})})}),e(ht,{children:"Select (V)"})]}),t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"text"===p?"default":"ghost",size:"icon",onClick:function(){g("text"),v("New text")},className:"h-9 w-9",children:e(S,{className:"h-5 w-5"})})}),e(ht,{children:"Add Text (T)"})]}),t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"shape"===p?"default":"ghost",size:"icon",onClick:function(){g("shape"),y()},className:"h-9 w-9",children:e(C,{className:"h-5 w-5"})})}),e(ht,{children:"Add Rectangle (R)"})]}),t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"shape"===p?"default":"ghost",size:"icon",onClick:function(){g("shape"),b()},className:"h-9 w-9",children:e(k,{className:"h-5 w-5"})})}),e(ht,{children:"Add Circle (C)"})]}),t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"image"===p?"default":"ghost",size:"icon",onClick:function(){return g("image")},className:"h-9 w-9",children:e(z,{className:"h-5 w-5"})})}),e(ht,{children:"Add Image (I)"})]}),t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"draw"===p?"default":"ghost",size:"icon",onClick:function(){return g("draw")},className:"h-9 w-9",children:e(A,{className:"h-5 w-5"})})}),e(ht,{children:"Draw (D)"})]}),e("div",{className:"bg-secondary h-6 w-px mx-1"}),t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"ghost",size:"icon",onClick:function(){return B()},className:"h-9 w-9",children:e(T,{className:"h-5 w-5"})})}),e(ht,{children:"Select All (Ctrl+A)"})]}),t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"ghost",size:"icon",onClick:function(){return J()},className:"h-9 w-9",children:e(F,{className:"h-5 w-5"})})}),e(ht,{children:"Clear Canvas (Shift+Esc)"})]}),t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"ghost",size:"icon",onClick:f,className:"h-9 w-9",children:e(P,{className:"h-5 w-5"})})}),e(ht,{children:"Resize Canvas"})]})]}),t("div",{className:"flex items-center gap-2 ml-auto mr-auto",children:[t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"ghost",size:"icon",onClick:s,className:"h-9 w-9",children:e(j,{className:"h-5 w-5"})})}),e(ht,{children:"Zoom Out (-)"})]}),t("div",{className:"text-sm font-medium w-16 text-center",children:[Math.round(100*m),"%"]}),t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"ghost",size:"icon",onClick:l,className:"h-9 w-9",children:e(O,{className:"h-5 w-5"})})}),e(ht,{children:"Zoom In (+)"})]}),t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"ghost",size:"icon",onClick:c,className:"h-9 w-9",children:e(R,{className:"h-5 w-5"})})}),e(ht,{children:"Reset Zoom (0)"})]})]}),t("div",{className:"flex items-center gap-2",children:[t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"ghost",size:"icon",onClick:function(e){e.preventDefault(),console.log("Undo button clicked"),i()},className:"h-9 w-9",children:e(E,{className:"h-5 w-5"})})}),e(ht,{children:"Undo (Ctrl+Z)"})]}),t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"ghost",size:"icon",onClick:function(e){e.preventDefault(),console.log("Redo button clicked"),o()},className:"h-9 w-9",children:e(L,{className:"h-5 w-5"})})}),e(ht,{children:"Redo (Ctrl+Y)"})]}),e("div",{className:"bg-secondary h-6 w-px mx-1"}),t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"ghost",size:"icon",onClick:x,className:"h-9 w-9",children:e(W,{className:"h-5 w-5"})})}),e(ht,{children:"Delete (Del)"})]}),t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"ghost",size:"icon",className:"h-9 w-9",children:e(U,{className:"h-5 w-5"})})}),e(ht,{children:"Copy (Ctrl+C)"})]}),e("div",{className:"bg-secondary h-6 w-px mx-1"}),t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"ghost",size:"icon",onClick:n,className:"h-9 w-9",children:e(D,{className:"h-5 w-5"})})}),e(ht,{children:"Save (Ctrl+S)"})]}),t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"ghost",size:"icon",onClick:function(){return r("png")},className:"h-9 w-9",children:e(I,{className:"h-5 w-5"})})}),e(ht,{children:"Export"})]}),e("div",{className:"bg-secondary h-6 w-px mx-1"}),t(mt,{children:[e(ft,{asChild:!0,children:e(At,{variant:"ghost",size:"icon",onClick:u,className:"h-9 w-9",children:e(M,{className:"h-5 w-5"})})}),e(ht,{children:"Toggle Properties"})]})]})]})})},Ft=Ke.Root,Pt=r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e(Ke.List,it({ref:a,className:dt("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r)},n))}));Pt.displayName=Ke.List.displayName;var jt=r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e(Ke.Trigger,it({ref:a,className:dt("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",r)},n))}));jt.displayName=Ke.Trigger.displayName;var Ot=r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e(Ke.Content,it({ref:a,className:dt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r)},n))}));Ot.displayName=Ke.Content.displayName;var Rt=r.forwardRef((function(a,r){var n=a.className,i=a.children,o=ot(a,["className","children"]);return t(Ge.Root,it({ref:r,className:dt("relative overflow-hidden",n)},o,{children:[e(Ge.Viewport,{className:"h-full w-full rounded-[inherit]",children:i}),e(Et,{}),e(Ge.Corner,{})]}))}));Rt.displayName=Ge.Root.displayName;var Et=r.forwardRef((function(t,a){var r=t.className,n=t.orientation,i=void 0===n?"vertical":n,o=ot(t,["className","orientation"]);return e(Ge.ScrollAreaScrollbar,it({ref:a,orientation:i,className:dt("flex touch-none select-none transition-colors","vertical"===i&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===i&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r)},o,{children:e(Ge.ScrollAreaThumb,{className:"relative flex-1 rounded-full bg-border"})}))}));Et.displayName=Ge.ScrollAreaScrollbar.displayName;var Lt=0;var Wt=new Map,Ut=function(e){if(!Wt.has(e)){var t=setTimeout((function(){Wt.delete(e),Bt({type:"REMOVE_TOAST",toastId:e})}),1e6);Wt.set(e,t)}},Dt=function(e,t){switch(t.type){case"ADD_TOAST":return it(it({},e),{toasts:ct([t.toast],e.toasts,!0).slice(0,1)});case"UPDATE_TOAST":return it(it({},e),{toasts:e.toasts.map((function(e){return e.id===t.toast.id?it(it({},e),t.toast):e}))});case"DISMISS_TOAST":var a=t.toastId;return a?Ut(a):e.toasts.forEach((function(e){Ut(e.id)})),it(it({},e),{toasts:e.toasts.map((function(e){return e.id===a||void 0===a?it(it({},e),{open:!1}):e}))});case"REMOVE_TOAST":return void 0===t.toastId?it(it({},e),{toasts:[]}):it(it({},e),{toasts:e.toasts.filter((function(e){return e.id!==t.toastId}))})}},It=[],Mt={toasts:[]};function Bt(e){Mt=Dt(Mt,e),It.forEach((function(e){e(Mt)}))}function Jt(e){var t=ot(e,[]),a=(Lt=(Lt+1)%Number.MAX_SAFE_INTEGER).toString(),r=function(){return Bt({type:"DISMISS_TOAST",toastId:a})};return Bt({type:"ADD_TOAST",toast:it(it({},t),{id:a,open:!0,onOpenChange:function(e){e||r()}})}),{id:a,dismiss:r,update:function(e){return Bt({type:"UPDATE_TOAST",toast:it(it({},e),{id:a})})}}}function Ht(){var e=r.useState(Mt),t=e[0],a=e[1];return r.useEffect((function(){return It.push(a),function(){var e=It.indexOf(a);e>-1&&It.splice(e,1)}}),[t]),it(it({},t),{toast:Jt,dismiss:function(e){return Bt({type:"DISMISS_TOAST",toastId:e})}})}var qt=r.forwardRef((function(t,a){var r=t.className,n=t.type,i=ot(t,["className","type"]);return e("input",it({type:n,className:dt("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:a},i))}));qt.displayName="Input";var Vt=x("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Kt=r.forwardRef((function(t,a){var r=t.className,n=t.variant,i=ot(t,["className","variant"]);return e("div",it({ref:a,role:"alert",className:dt(Vt({variant:n}),r)},i))}));Kt.displayName="Alert",r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e("h5",it({ref:a,className:dt("mb-1 font-medium leading-none tracking-tight",r)},n))})).displayName="AlertTitle";var Gt=r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e("div",it({ref:a,className:dt("text-sm [&_p]:leading-relaxed",r)},n))}));Gt.displayName="AlertDescription";var Xt=function(e,t,a,r){var n=t.get?t.get("bounds"):null;if(n&&"object"==typeof n&&void 0!==n.right&&void 0!==n.left&&void 0!==n.bottom&&void 0!==n.top)e.set({left:n.left,top:n.top,selectable:!0});else{var i=t.left||t.x||0,o=t.top||t.y||0;0===i&&0===o&&a&&r?e.set({left:a/2,top:r/2,originX:"center",originY:"center",selectable:!0}):e.set({left:i,top:o,selectable:!0})}},Yt=function(e,t){return lt(void 0,void 0,void 0,(function(){return st(this,(function(a){return[2,new Promise((function(a){try{var r=e.get("typeTool")||{},n="Text layer";e.text?n=e.text:r.textData&&r.textData.text&&(n=r.textData.text);var i={left:e.left||0,top:e.top||0,fontSize:20,fontFamily:"Arial",fill:"#000000"};r.style&&(r.style.fontSize&&(i.fontSize=r.style.fontSize),r.style.fontName&&(i.fontFamily=r.style.fontName),r.style.color&&(i.fill=r.style.color));var o=new g.Text(n,i);Xt(o,e,0,0),t.add(o),a()}catch(e){console.error("Error processing text layer:",e),a()}}))]}))}))},_t=function(e,t,a,r){return lt(void 0,void 0,void 0,(function(){return st(this,(function(n){return[2,new Promise((function(n){try{console.log("Adding pixel data layer for node:",e.name||"Unnamed Layer");var i=document.createElement("canvas"),o=i.getContext("2d");if(o){var l=e.width(),s=e.height();if(l<=0||s<=0)return console.log("Layer has zero or negative dimensions, skipping"),void n();i.width=l,i.height=s;try{if(e.image&&e.image.pixelData&&e.image.pixelData.length>0){var c=new ImageData(new Uint8ClampedArray(e.image.pixelData),l,s);o.putImageData(c,0,0);var d=i.toDataURL("image/png");g.Image.fromURL(d,(function(i){if(!i)return console.error("Failed to create fabric image from pixel data layer"),void n();Xt(i,e,a,r),e.name&&i.set("name",e.name),t.add(i),n()}),{crossOrigin:"anonymous"})}else console.log("No pixel data available for this layer, skipping"),n()}catch(e){console.error("Error creating ImageData:",e),n()}}else n()}catch(e){console.error("Error processing pixel data layer:",e),n()}}))]}))}))},Zt=function(e,t,a,r,n){return lt(void 0,void 0,void 0,(function(){var e,i,o;return st(this,(function(l){switch(l.label){case 0:e=0,i=[];try{i=t.descendants()||[],console.log("Found ".concat(i.length," descendants")),i.reverse()}catch(e){return console.error("Error getting descendants:",e),[2,{layersAdded:0}]}return o=i.map((function(t,i){return lt(void 0,void 0,void 0,(function(){var o,l,s,c,d;return st(this,(function(u){switch(u.label){case 0:if(!t)return[2];if(console.log("Processing layer ".concat(i,":"),t.name||"Unnamed Layer"),"function"==typeof t.isGroup&&t.isGroup())return console.log("This is a group, skipping direct processing"),[2];if(!1===t.visible)return console.log("Layer is invisible, skipping"),[2];u.label=1;case 1:return u.trys.push([1,23,,24]),t.get&&(t.get("typeTool")||t.text)?(console.log("Processing text layer"),[4,Yt(t,a)]):[3,3];case 2:return u.sent(),e++,[2];case 3:if(!t.toPng)return[3,19];u.label=4;case 4:return u.trys.push([4,13,,18]),console.log("Processing layer with toPng()"),(o=t.toPng())?(l="",o instanceof HTMLCanvasElement?(l=o.toDataURL("image/png"),[3,8]):[3,5]):[3,10];case 5:return"object"==typeof o&&o.toDataURL?(l=o.toDataURL("image/png"),[3,8]):[3,6];case 6:return console.log("Unrecognized toPng() result, falling back to pixel data"),[4,_t(t,a,r,n)];case 7:return u.sent(),e++,[2];case 8:return[4,new Promise((function(i){g.Image.fromURL(l,(function(o){if(!o)return console.error("Failed to create fabric image from layer"),void i();Xt(o,t,r,n),t.name&&o.set("name",t.name),a.add(o),e++,i()}),{crossOrigin:"anonymous"})}))];case 9:return u.sent(),[3,12];case 10:return console.log("toPng() returned nothing, falling back to pixel data"),[4,_t(t,a,r,n)];case 11:u.sent(),e++,u.label=12;case 12:return[3,18];case 13:s=u.sent(),console.error("Error processing layer with toPng:",s),u.label=14;case 14:return u.trys.push([14,16,,17]),console.log("toPng() failed, falling back to pixel data"),[4,_t(t,a,r,n)];case 15:return u.sent(),e++,[3,17];case 16:return c=u.sent(),console.error("Fallback pixel data layer also failed:",c),[3,17];case 17:return[3,18];case 18:return[3,22];case 19:return t.image&&t.image.pixelData?(console.log("Processing layer with pixel data"),[4,_t(t,a,r,n)]):[3,21];case 20:return u.sent(),e++,[3,22];case 21:console.log("Layer has no usable image data, skipping"),u.label=22;case 22:return[3,24];case 23:return d=u.sent(),console.error("Error processing layer:",d),[3,24];case 24:return[2]}}))}))})),[4,Promise.all(o.filter(Boolean))];case 1:return l.sent(),console.log("Added ".concat(e," layers to canvas")),[2,{layersAdded:e}]}}))}))},Qt=function(e,t,a,r){return lt(void 0,void 0,void 0,(function(){return st(this,(function(n){return[2,new Promise((function(n){try{var i=e.image.toPng();if(i){var o=void 0;if(i instanceof HTMLCanvasElement)o=i.toDataURL("image/png");else if("object"==typeof i&&i.toDataURL)o=i.toDataURL("image/png");else{var l=document.createElement("canvas");l.width=a,l.height=r;var s=l.getContext("2d");if(!s||!e.image.pixelData)return void n({success:!1});var c=new ImageData(new Uint8ClampedArray(e.image.pixelData),a,r);s.putImageData(c,0,0),o=l.toDataURL("image/png")}g.Image.fromURL(o,(function(e){e?(e.scaleToWidth(a),t.add(e),t.renderAll(),console.log("Loaded composite image successfully"),n({success:!0})):n({success:!1})}),{crossOrigin:"anonymous"})}else n({success:!1})}catch(e){console.error("Error loading composite image:",e),n({success:!1})}}))]}))}))},$t=function(e,t,a,r){return lt(void 0,void 0,void 0,(function(){return st(this,(function(n){return[2,new Promise((function(n){try{var i=e.image.pixelData;if(i&&a&&r){var o=document.createElement("canvas");o.width=a,o.height=r;var l=o.getContext("2d");if(l){var s=new ImageData(new Uint8ClampedArray(i),a,r);l.putImageData(s,0,0);var c=o.toDataURL("image/png");g.Image.fromURL(c,(function(e){e?(e.scaleToWidth(a),t.add(e),t.renderAll(),console.log("Loaded flattened image successfully"),n({success:!0})):n({success:!1})}),{crossOrigin:"anonymous"})}else n({success:!1})}else n({success:!1})}catch(e){console.error("Error loading flattened image:",e),n({success:!1})}}))]}))}))},ea=function(e){return lt(void 0,void 0,void 0,(function(){var t,a,r,n;return st(this,(function(i){try{return t="user-template-".concat(Date.now()),a=e.thumbnailUrl,localStorage.setItem("template-json-".concat(t),e.canvasJson),r={id:t,name:e.name,thumbnailPath:a,jsonPath:"template-json-".concat(t),category:e.category,size:e.size},(n=ta()).push(r),aa(n),[2,!0]}catch(e){return console.error("Error saving template to folder:",e),[2,!1]}return[2]}))}))},ta=function(){var e=localStorage.getItem("userUploadedTemplates");if(!e)return[];try{return JSON.parse(e)}catch(e){return console.error("Error parsing user uploaded templates:",e),[]}},aa=function(e){localStorage.setItem("userUploadedTemplates",JSON.stringify(e))},ra=function(){var e=Ct(),t=e.canvas,a=e.setCanvasSize,r=e.saveToHistory,n=o([]),i=n[0],c=n[1],d=o([]);d[0],d[1];var u=o(!1);u[0],u[1];var m=o(1);m[0],m[1];var f=o("nature");f[0],f[1],l((function(){var e=localStorage.getItem("userTemplates");if(e)try{c(JSON.parse(e))}catch(e){console.error("Error loading user templates:",e),localStorage.removeItem("userTemplates")}}),[]),l((function(){i.length>0&&localStorage.setItem("userTemplates",JSON.stringify(i))}),[i]);var h=s((function(){return[{id:"psd-template-1",name:"Business Card Template",thumbnailUrl:"/psd-templates/business-card-thumb.jpg",demoUrl:"/psd-templates/business-card-demo.jpg",size:{width:1050,height:600},category:"cards"},{id:"psd-template-2",name:"Social Media Post",thumbnailUrl:"/psd-templates/social-post-thumb.jpg",demoUrl:"/psd-templates/social-post-demo.jpg",size:{width:1080,height:1080},category:"social"},{id:"psd-template-3",name:"Website Banner",thumbnailUrl:"/psd-templates/banner-thumb.jpg",demoUrl:"/psd-templates/banner-demo.jpg",size:{width:1200,height:300},category:"banners"},{id:"psd-template-4",name:"Company Logo",thumbnailUrl:"/psd-templates/logo-thumb.jpg",demoUrl:"/psd-templates/logo-demo.jpg",size:{width:500,height:500},category:"logos"},{id:"psd-template-5",name:"Email Newsletter",thumbnailUrl:"/psd-templates/email-thumb.jpg",demoUrl:"/psd-templates/email-demo.jpg",size:{width:600,height:800},category:"emails"}]}),[]),p=s((function(){return i}),[i]),v=s((function(e,a,r){if(!t)return y.error("Canvas not initialized"),!1;try{var n=r||t.toDataURL({format:"jpeg",quality:.8,multiplier:.5}),i={id:"user-template-".concat(Date.now()),name:e,category:a,thumbnailUrl:n,size:{width:t.width||0,height:t.height||0},canvasJson:JSON.stringify(t.toJSON(["id","name"])),dateCreated:(new Date).toISOString()};return c((function(e){return ct(ct([],e,!0),[i],!1)})),y.success('Template "'.concat(e,'" saved successfully')),!0}catch(e){return console.error("Error saving template:",e),y.error("Failed to save template: ".concat(e instanceof Error?e.message:"Unknown error")),!1}}),[t]),b=s((function(e){c((function(t){return t.filter((function(t){return t.id!==e}))})),y.success("Template deleted successfully")}),[]),x=s((function(e){if(t){a(e.size),t.clear();try{g.Image.fromURL(e.demoUrl,(function(a){if(!a)return console.error("Failed to load image from ".concat(e.demoUrl)),void y.error("Failed to load template image. Please try another template.");var n=Math.min(e.size.width/(a.width||1),e.size.height/(a.height||1));a.set({scaleX:n,scaleY:n,left:(e.size.width-(a.width||0)*n)/2,top:(e.size.height-(a.height||0)*n)/2,selectable:!0}),t.add(a),t.renderAll(),r(t),y.success('Template "'.concat(e.name,'" loaded successfully'))}),{crossOrigin:"anonymous"})}catch(e){console.error("Error loading template image:",e),y.error("Failed to load template image: ".concat(e instanceof Error?e.message:"Unknown error"))}}else y.error("Canvas not initialized")}),[t,a,r]),N=s((function(e){if(t){a(e.size),t.clear();try{g.Image.fromURL(e.demoUrl,(function(a){if(!a)return console.error("Failed to load image from ".concat(e.demoUrl)),void y.error("Failed to load template image. Please try another template.");var n=Math.min(e.size.width/(a.width||1),e.size.height/(a.height||1));a.set({scaleX:n,scaleY:n,left:(e.size.width-(a.width||0)*n)/2,top:(e.size.height-(a.height||0)*n)/2,selectable:!0,hasControls:!0,hasBorders:!0}),t.add(a),t.renderAll(),r(t),e.photographer?y.success("Photo by ".concat(e.photographer," on Pexels")):y.success('Template "'.concat(e.name,'" loaded successfully'))}),{crossOrigin:"anonymous"})}catch(e){console.error("Error loading Pexels template:",e),y.error("Failed to load template: ".concat(e instanceof Error?e.message:"Unknown error"))}}else y.error("Canvas not initialized")}),[t,a,r]),w=s((function(e){return lt(void 0,void 0,void 0,(function(){var n,i;return st(this,(function(o){switch(o.label){case 0:if(!t)return y.error("Canvas not initialized"),[2];a(e.size),t.clear(),o.label=1;case 1:return o.trys.push([1,4,,5]),e.jsonPath?[4,(l=e.jsonPath,lt(void 0,void 0,void 0,(function(){var e,t,a,r;return st(this,(function(n){switch(n.label){case 0:if(!l)return[2,null];n.label=1;case 1:if(n.trys.push([1,4,,5]),l.startsWith("template-json-")){if(!(e=localStorage.getItem(l)))throw new Error("Template JSON not found in localStorage: ".concat(l));return[2,e]}return[4,fetch(l)];case 2:if(!(t=n.sent()).ok)throw new Error("Failed to load template JSON: ".concat(t.statusText));return[4,t.json()];case 3:return a=n.sent(),[2,JSON.stringify(a)];case 4:return r=n.sent(),console.error("Error loading template JSON:",r),[2,null];case 5:return[2]}}))})))]:[3,3];case 2:if(n=o.sent())return t.loadFromJSON(n,(function(){t.renderAll(),r(t),y.success('Template "'.concat(e.name,'" loaded successfully'))})),[2];o.label=3;case 3:return g.Image.fromURL(e.demoUrl||e.thumbnailUrl,(function(a){if(!a)return console.error("Failed to load image from ".concat(e.thumbnailUrl)),void y.error("Failed to load template image. Please try another template.");var n=Math.min(e.size.width/(a.width||1),e.size.height/(a.height||1));a.set({scaleX:n,scaleY:n,left:(e.size.width-(a.width||0)*n)/2,top:(e.size.height-(a.height||0)*n)/2,selectable:!0}),t.add(a),t.renderAll(),r(t),y.success('Template "'.concat(e.name,'" loaded successfully'))}),{crossOrigin:"anonymous"}),[3,5];case 4:return i=o.sent(),console.error("Error loading template:",i),y.error("Failed to load template: ".concat(i instanceof Error?i.message:"Unknown error")),[3,5];case 5:return[2]}var l}))}))}),[t,a,r]);return{getPsdTemplates:h,getUserTemplates:p,loadDemoTemplate:x,loadPexelsTemplate:N,loadUserTemplate:s((function(e){if(t){a(e.size),t.clear();try{e.canvasJson?t.loadFromJSON(e.canvasJson,(function(){t.renderAll(),r(t),y.success('Template "'.concat(e.name,'" loaded successfully'))})):g.Image.fromURL(e.thumbnailUrl,(function(a){if(!a)return console.error("Failed to load image from ".concat(e.thumbnailUrl)),void y.error("Failed to load template image. Please try another template.");var n=Math.min(e.size.width/(a.width||1),e.size.height/(a.height||1));a.set({scaleX:n,scaleY:n,left:(e.size.width-(a.width||0)*n)/2,top:(e.size.height-(a.height||0)*n)/2,selectable:!0}),t.add(a),t.renderAll(),r(t),y.success('Template "'.concat(e.name,'" loaded successfully'))}),{crossOrigin:"anonymous"})}catch(e){console.error("Error loading user template:",e),y.error("Failed to load template: ".concat(e instanceof Error?e.message:"Unknown error"))}}else y.error("Canvas not initialized")}),[t,a,r]),saveAsTemplate:v,deleteUserTemplate:b,loadTemplateFromFolder:w}},na=function(){var e=function(){var e=Ct(),t=e.canvas,a=e.setCanvasSize,r=e.saveToHistory,n=s((function(e){return lt(void 0,void 0,void 0,(function(){var n,i,o,l,s,c,d,u,m,f,h,p,g,v,b;return st(this,(function(x){switch(x.label){case 0:if(!t)return y.error("Canvas not initialized"),[2,!1];x.label=1;case 1:return x.trys.push([1,20,,21]),n=y.loading("Processing PSD file...",{duration:6e4}),[4,e.arrayBuffer()];case 2:if(!(i=x.sent())||0===i.byteLength)return y.dismiss(n),y.error("Invalid PSD file: Empty file"),[2,!1];console.log("PSD file size: ".concat((i.byteLength/1024/1024).toFixed(2)," MB")),x.label=3;case 3:return x.trys.push([3,18,,19]),[4,(o=new Xe(new Uint8Array(i))).parse()];case 4:if(x.sent(),l=o.header.width,s=o.header.height,console.log("PSD dimensions: ".concat(l,"x").concat(s)),!l||!s||l<=0||s<=0)return y.dismiss(n),y.error("Invalid PSD dimensions"),[2,!1];a({width:l,height:s}),t.clear(),console.log("PSD loaded, processing layers..."),c=!1,d=void 0,x.label=5;case 5:return x.trys.push([5,8,,9]),[4,(d=o.tree()).export()];case 6:return x.sent(),console.log("PSD tree structure:",d),[4,Zt(0,d,t,l,s)];case 7:return(u=x.sent()).layersAdded>0?(console.log("Successfully added ".concat(u.layersAdded," layers to canvas")),c=!0,t.renderAll()):console.log("No layers were added, falling back to composite image"),[3,9];case 8:return m=x.sent(),console.error("Error processing layer tree:",m),[3,9];case 9:if(c)return[3,13];x.label=10;case 10:return x.trys.push([10,12,,13]),[4,Qt(o,t,l,s)];case 11:return f=x.sent(),c=f.success,[3,13];case 12:return h=x.sent(),console.error("Error getting composite image:",h),[3,13];case 13:if(c)return[3,17];x.label=14;case 14:return x.trys.push([14,16,,17]),[4,$t(o,t,l,s)];case 15:return p=x.sent(),c=p.success,[3,17];case 16:return g=x.sent(),console.error("Error creating flattened image:",g),[3,17];case 17:return c?(t.renderAll(),r(t),y.dismiss(n),y.success("PSD template loaded successfully"),[2,!0]):(y.dismiss(n),y.error("Could not extract any content from the PSD file"),[2,!1]);case 18:return v=x.sent(),console.error("Error parsing PSD file:",v),y.dismiss(n),y.error("Failed to parse PSD: ".concat(v.message||"Unknown parsing error")),[2,!1];case 19:return[3,21];case 20:return b=x.sent(),console.error("Error loading PSD file:",b),y.error("Failed to load PSD: ".concat(b.message||"Unknown error")),[2,!1];case 21:return[2]}}))}))}),[t,a,r]);return{loadPsdTemplate:n}}().loadPsdTemplate,t=ra(),a=t.getUserTemplates,r=t.loadDemoTemplate,n=t.loadUserTemplate,i=t.saveAsTemplate,o=t.deleteUserTemplate,l=t.loadTemplateFromFolder,c=Ct().canvas,d=s((function(){return lt(void 0,void 0,void 0,(function(){return st(this,(function(e){switch(e.label){case 0:return[4,lt(void 0,void 0,void 0,(function(){var e,t;return st(this,(function(a){try{return e=[{id:"template-1",name:"Business Card",thumbnailPath:"/lovable-uploads/b334919b-439f-4f5f-87cc-7e184bfe32fa.png",jsonPath:"/templates/template-1.json",category:"cards",size:{width:1050,height:600}},{id:"template-2",name:"Sify Datacenter",thumbnailPath:"/lovable-uploads/bb5ca99e-c258-43b3-a7f4-bd7275e9800b.png",jsonPath:"/templates/template-2.json",category:"banners",size:{width:1200,height:300}},{id:"template-3",name:"Booking Website",thumbnailPath:"/lovable-uploads/1b004328-4b62-42cf-824f-eb28ba216b41.png",jsonPath:"/templates/template-3.json",category:"banners",size:{width:1200,height:300}},{id:"template-4",name:"Building Architecture",thumbnailPath:"/lovable-uploads/aad5799a-e123-4317-84ab-a244c43db70f.png",jsonPath:"/templates/template-4.json",category:"cards",size:{width:1050,height:600}},{id:"template-5",name:"Fitness Poster",thumbnailPath:"/lovable-uploads/b8574978-0893-4eb8-a139-41dc75c6f9be.png",jsonPath:"/templates/template-5.json",category:"social",size:{width:1080,height:1920}},{id:"template-6",name:"Template C",thumbnailPath:"/lovable-uploads/c86ad02e-540f-459f-8f26-30c296964f27.png",jsonPath:"/templates/template-6.json",category:"websites",size:{width:1200,height:900}},{id:"template-7",name:"Dark Pattern",thumbnailPath:"/lovable-uploads/dc67de50-725f-4c0f-b351-4c306d933e82.png",jsonPath:"/templates/template-7.json",category:"backgrounds",size:{width:1080,height:1080}}],t=ta(),[2,ct(ct([],e,!0),t,!0).map((function(e){return{id:e.id,name:e.name,thumbnailUrl:e.thumbnailPath,demoUrl:e.thumbnailPath,size:e.size,category:e.category,jsonPath:e.jsonPath}}))]}catch(e){return console.error("Error fetching templates:",e),[2,[]]}return[2]}))}))];case 1:return[2,e.sent().filter((function(e){return"psd-uploads"===e.category}))]}}))}))}),[]),u=s((function(t){return lt(void 0,void 0,void 0,(function(){var a,r,n,i,o;return st(this,(function(l){switch(l.label){case 0:return l.trys.push([0,3,,4]),[4,e(t)];case 1:return l.sent()&&c?(a=c.toDataURL({format:"jpeg",quality:.7,multiplier:.5}),r=JSON.stringify(c.toJSON(["id","name"])),n=t.name.replace(/\.[^/.]+$/,""),i={name:n,thumbnailUrl:a,canvasJson:r,size:{width:c.width||800,height:c.height||600},category:"psd-uploads"},console.log("Saving PSD template:",i),[4,ea(i)]):(y.error("Failed to load PSD file for template creation"),[2,!1]);case 2:return l.sent()?(y.success('Template "'.concat(n,'" saved successfully to template folder')),[2,!0]):(y.error("Failed to save template to folder"),[2,!1]);case 3:return o=l.sent(),console.error("Error uploading PSD as template:",o),y.error("Error creating template: ".concat(o instanceof Error?o.message:"Unknown error")),[2,!1];case 4:return[2]}}))}))}),[e,c]);return{loadPsdTemplate:e,getPsdTemplates:d,getUserTemplates:a,loadDemoTemplate:r,loadUserTemplate:n,saveAsTemplate:i,deleteUserTemplate:o,loadTemplateFromFolder:l,uploadPsdAsTemplate:u}},ia=function(r){var n=r.acceptedTypes,i=void 0===n?".psd,.png,.jpg,.jpeg,.svg,.fig":n,l=r.maxSizeMB,s=void 0===l?100:l,c=r.onSuccess,d=r.saveAsTemplate,u=void 0!==d&&d,m=o(!1),f=m[0],h=m[1],p=na(),v=p.loadPsdTemplate,b=p.uploadPsdAsTemplate,x=Ct(),N=x.canvas,w=x.setCanvasSize,S=x.saveToHistory;x.exportToImage;return e("div",{children:t("label",{htmlFor:"file-upload",children:[t("div",{className:"border-2 border-dashed border-border rounded-md p-4 text-center cursor-pointer hover:border-primary transition-colors",children:[f?e(B,{className:"h-10 w-10 mx-auto mb-2 text-muted-foreground animate-spin"}):e(a,{children:u?t("div",{className:"flex items-center justify-center mb-2",children:[e(J,{className:"h-8 w-8 text-muted-foreground"}),e(D,{className:"h-6 w-6 text-muted-foreground ml-1"})]}):e(J,{className:"h-10 w-10 mx-auto mb-2 text-muted-foreground"})}),e("p",{className:"text-sm font-medium",children:u?"Upload as Template":"Upload File"}),e("p",{className:"text-xs text-muted-foreground mt-1",children:u?"Add PSD or images directly to your templates library":"Import PSD (up to ".concat(s,"MB), images, or exported Figma designs")}),f&&t("div",{className:"mt-2",children:[e("div",{className:"h-1 w-full bg-muted rounded-full overflow-hidden",children:e("div",{className:"h-full bg-primary animate-pulse rounded-full"})}),e("p",{className:"text-xs text-muted-foreground mt-1",children:"Processing file... This may take a moment"})]})]}),e("input",{id:"file-upload",type:"file",accept:i,className:"hidden",onChange:function(e){return lt(void 0,void 0,void 0,(function(){var t,a,r,n,i,o;return st(this,(function(l){switch(l.label){case 0:if(!(t=null===(o=e.target.files)||void 0===o?void 0:o[0]))return[2];if((a=t.size/1048576)>s)return y.error("File is too large. Maximum size is ".concat(s,"MB.")),[2];h(!0),l.label=1;case 1:return l.trys.push([1,8,9,10]),d=t.name,r=d.slice(2+(d.lastIndexOf(".")-1>>>0)).toLowerCase(),console.log("Processing ".concat(r," file:"),t.name,"size:",a.toFixed(2),"MB"),"psd"!==r?[3,6]:u?[4,b(t)]:[3,3];case 2:return l.sent(),[3,5];case 3:return[4,v(t)];case 4:l.sent(),l.label=5;case 5:return[3,7];case 6:if(["png","jpg","jpeg","svg"].includes(r)){if(!N)return y.error("Canvas not initialized"),[2];(n=new FileReader).onload=function(e){return lt(void 0,void 0,void 0,(function(){var a,r;return st(this,(function(n){return a=null===(r=e.target)||void 0===r?void 0:r.result,g.Image.fromURL(a,(function(e){return lt(void 0,void 0,void 0,(function(){var a,r,n,i,o,l,s,c,d;return st(this,(function(m){switch(m.label){case 0:return e?(a=N.width||800,r=N.height||600,n=e.width||0,i=e.height||0,(n>a||i>r)&&w({width:Math.max(a,n),height:Math.max(r,i)}),(o=Math.min(a/(n||1),r/(i||1)))<1&&e.scale(o),e.set({left:(a-n*(o<1?o:1))/2,top:(r-i*(o<1?o:1))/2,selectable:!0}),u&&N.clear(),N.add(e),N.renderAll(),S(N),u?(l=t.name.replace(/\.[^/.]+$/,""),s=N.toDataURL({format:"jpeg",quality:.7,multiplier:.5}),c=JSON.stringify(N.toJSON(["id","name"])),d={name:l,thumbnailUrl:s,canvasJson:c,size:{width:N.width||800,height:N.height||600},category:"image-uploads"},[4,ea(d)]):[3,2]):(console.error("Failed to load image"),y.error("Failed to load image file. Please try another file."),[2]);case 1:return m.sent()?y.success('Image "'.concat(l,'" saved successfully as template')):y.error("Failed to save image as template"),[3,3];case 2:y.success("Image loaded successfully"),m.label=3;case 3:return[2]}}))}))})),[2]}))}))},n.readAsDataURL(t)}else"fig"===r?y.info("Figma files cannot be directly imported. Please export your Figma design as PNG or JPG first."):y.error("Unsupported file type: ".concat(r));l.label=7;case 7:return c&&c(),[3,10];case 8:return i=l.sent(),console.error("Error uploading file:",i),y.error("Failed to process file: ".concat(i.message||"Unknown error")),[3,10];case 9:return h(!1),e.target.value="",[7];case 10:return[2]}var d}))}))},disabled:f})]})})},oa=function(r){var n=r.onImageSelect,i=o([]),s=i[0],c=i[1],d=o(""),u=d[0],m=d[1],f=o(!1),h=f[0],p=f[1],g=o(1),v=g[0],y=g[1],b=o(!0),x=b[0],N=b[1],w=o(null),S=w[0],C=w[1];l((function(){k(!1)}),[]);var k=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return lt(void 0,ct([],e,!0),void 0,(function(e){var t,a,r,n,i,o,l;return void 0===e&&(e=!1),st(this,(function(s){switch(s.label){case 0:p(!0),C(null),s.label=1;case 1:return s.trys.push([1,4,5,6]),t=e?1:v+1,a=void 0,a=u&&e?"https://api.unsplash.com/search/photos?query=".concat(encodeURIComponent(u),"&page=").concat(t,"&per_page=").concat(6):"https://api.unsplash.com/photos?page=".concat(t,"&per_page=").concat(6),[4,fetch(a,{headers:{Authorization:"Client-ID ".concat("55vVhZ-tFehN51yXwGIoDveBQRovUM50ZZptfPhdtRU")}})];case 2:if(!(r=s.sent()).ok)throw new Error("Unsplash API error: ".concat(r.status));return[4,r.json()];case 3:return n=s.sent(),i=u&&e?n.results.map((function(e){return{id:e.id,url:e.urls.regular,thumb:e.urls.thumb,description:e.alt_description||e.description||"Unsplash image",user:{name:e.user.name,username:e.user.username}}})):n.map((function(e){return{id:e.id,url:e.urls.regular,thumb:e.urls.thumb,description:e.alt_description||e.description||"Unsplash image",user:{name:e.user.name,username:e.user.username}}})),e?(c(i),y(1)):(c((function(e){return ct(ct([],e,!0),i,!0)})),y(t)),o=u?n.total_pages:100,N(t<o),[3,6];case 4:return l=s.sent(),console.error("Error fetching images:",l),C("Failed to fetch images from Unsplash."),[3,6];case 5:return p(!1),[7];case 6:return[2]}}))}))};return t("div",{className:"space-y-4",children:[t("form",{onSubmit:function(e){e.preventDefault(),u.trim()&&k(!0)},className:"flex gap-2",children:[e(qt,{type:"text",placeholder:"Search images...",value:u,onChange:function(e){return m(e.target.value)},className:"flex-1"}),e(At,{type:"submit",size:"sm",disabled:h,children:h&&u?e(B,{className:"h-4 w-4 animate-spin"}):e(H,{className:"h-4 w-4"})})]}),S&&t(Kt,{variant:"destructive",children:[e(q,{className:"h-4 w-4"}),e(Gt,{children:S})]}),e("div",{className:"grid grid-cols-2 gap-2",children:s.map((function(a){return t("div",{className:"aspect-square rounded-md overflow-hidden cursor-pointer hover:opacity-90 transition-opacity relative group",onClick:function(){return function(e){n(e.url)}(a)},children:[e("img",{src:a.thumb,alt:a.description,className:"w-full h-full object-cover",loading:"lazy"}),e("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all flex items-center justify-center",children:e(V,{className:"text-white opacity-0 group-hover:opacity-100 transition-opacity h-8 w-8"})}),t("div",{className:"absolute bottom-0 left-0 right-0 p-1 bg-black bg-opacity-50 text-white text-xs truncate opacity-0 group-hover:opacity-100 transition-opacity",children:["Photo by ",a.user.name]})]},a.id)}))}),h&&0===s.length&&e("div",{className:"flex justify-center items-center py-8",children:e(B,{className:"h-8 w-8 animate-spin text-primary"})}),!h&&0===s.length&&e("div",{className:"text-center py-8 text-muted-foreground",children:e("p",{children:"No images found. Try a different search term."})}),s.length>0&&x&&e(At,{variant:"outline",className:"w-full flex items-center justify-center gap-2",onClick:function(){k(!1)},disabled:h,children:t(a,h?{children:[e(B,{className:"h-4 w-4 animate-spin"}),"Loading..."]}:{children:[e(K,{className:"h-4 w-4"}),"Load More"]})}),t("div",{className:"text-xs text-center text-muted-foreground pt-2 pb-4",children:["Photos provided by ",e("a",{href:"https://unsplash.com",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Unsplash"})]}),e("div",{className:"pt-4 border-t border-border",children:e(ia,{})})]})},la=function(a){var r=a.addShape,n=o(""),i=n[0],l=n[1],s=o("basic"),c=s[0],d=s[1],u={basic:[{id:"rectangle",name:"Rectangle",icon:e(C,{className:"h-10 w-10"}),addFn:function(){return r("rect")}},{id:"circle",name:"Circle",icon:e(se,{className:"h-10 w-10"}),addFn:function(){return r("circle")}},{id:"triangle",name:"Triangle",icon:e(ce,{className:"h-10 w-10"}),addFn:function(){return r("triangle")}},{id:"diamond",name:"Diamond",icon:e("div",{className:"h-10 w-10 border-2 border-foreground rotate-45"}),addFn:function(){return r("diamond")}},{id:"ellipse",name:"Ellipse",icon:e("div",{className:"h-8 w-10 border-2 border-foreground rounded-full"}),addFn:function(){return r("ellipse")}},{id:"square",name:"Square",icon:e("div",{className:"h-9 w-9 border-2 border-foreground"}),addFn:function(){return r("square")}}],geometric:[{id:"pentagon",name:"Pentagon",icon:e(ae,{className:"h-10 w-10"}),addFn:function(){return r("pentagon")}},{id:"hexagon",name:"Hexagon",icon:e(re,{className:"h-10 w-10"}),addFn:function(){return r("hexagon")}},{id:"octagon",name:"Octagon",icon:e(ne,{className:"h-10 w-10"}),addFn:function(){return r("octagon")}},{id:"star",name:"Star",icon:e(ie,{className:"h-10 w-10"}),addFn:function(){return r("star")}},{id:"heart",name:"Heart",icon:e(oe,{className:"h-10 w-10"}),addFn:function(){return r("heart")}},{id:"grid",name:"Grid",icon:e(le,{className:"h-10 w-10"}),addFn:function(){return r("grid")}}],arrows:[{id:"arrow-right",name:"Right Arrow",icon:e(Z,{className:"h-10 w-10"}),addFn:function(){return r("arrow",{direction:"right"})}},{id:"arrow-left",name:"Left Arrow",icon:e(Q,{className:"h-10 w-10"}),addFn:function(){return r("arrow",{direction:"left"})}},{id:"arrow-up",name:"Up Arrow",icon:e($,{className:"h-10 w-10"}),addFn:function(){return r("arrow",{direction:"up"})}},{id:"arrow-down",name:"Down Arrow",icon:e(ee,{className:"h-10 w-10"}),addFn:function(){return r("arrow",{direction:"down"})}},{id:"double-arrow",name:"Double Arrow",icon:e(te,{className:"h-10 w-10"}),addFn:function(){return r("arrow",{type:"double"})}}],callouts:[{id:"message-square",name:"Square Callout",icon:e(Y,{className:"h-10 w-10"}),addFn:function(){return r("callout",{type:"square"})}},{id:"message-circle",name:"Round Callout",icon:e(_,{className:"h-10 w-10"}),addFn:function(){return r("callout",{type:"circle"})}}],special:[{id:"plus",name:"Plus",icon:e(G,{className:"h-10 w-10"}),addFn:function(){return r("plus")}},{id:"award",name:"Badge",icon:e(X,{className:"h-10 w-10"}),addFn:function(){return r("badge")}}]},m=function(){if(!i.trim())return u[c]||[];var e=i.toLowerCase(),t=[];return Object.values(u).forEach((function(a){a.forEach((function(a){a.name.toLowerCase().includes(e)&&t.push(a)}))})),t}();return t("div",{className:"space-y-4",children:[e(qt,{type:"text",placeholder:"Search shapes...",value:i,onChange:function(e){return l(e.target.value)},className:"w-full"}),!i&&e("div",{className:"flex flex-wrap gap-2 mb-4",children:[{id:"basic",name:"Basic"},{id:"geometric",name:"Geometric"},{id:"arrows",name:"Arrows"},{id:"callouts",name:"Callouts"},{id:"special",name:"Special"}].map((function(t){return e(At,{size:"sm",variant:c===t.id?"default":"outline",onClick:function(){return d(t.id)},className:"text-xs",children:t.name},t.id)}))}),t("div",{className:"grid grid-cols-3 gap-3",children:[m.map((function(a){return t("div",{className:"aspect-square border border-border rounded-md p-2 flex flex-col items-center justify-center cursor-pointer hover:border-primary hover:bg-accent transition-colors",onClick:a.addFn,children:[a.icon,e("span",{className:"text-xs mt-2 text-muted-foreground",children:a.name})]},a.id)})),0===m.length&&e("div",{className:"col-span-3 py-8 text-center text-muted-foreground",children:e("p",{children:"No shapes found. Try a different search term."})})]})]})},sa=function(a){var r=a.collapsed,n=a.onToggle,i=o("templates"),l=i[0],s=i[1],c=Ct(),d=c.addImage,u=c.addText,m=c.addRect,f=c.addCircle,h=c.addTriangle,p=c.setCanvasSize;c.canvas;var g=c.loadFromJSON,v=c.createBusinessCardTemplate,y=c.addShape,b=Ht().toast;ra().loadPexelsTemplate;var x={logos:[{id:"logo-1",name:"Simple Logo",type:"Logo",size:{width:500,height:500},preview:"Circle with text"},{id:"logo-2",name:"Abstract Logo",type:"Logo",size:{width:500,height:500},preview:"Triangles and squares"},{id:"logo-3",name:"Text Logo",type:"Logo",size:{width:600,height:300},preview:"Stylized company name"}],banners:[{id:"banner-1",name:"Website Header",type:"Banner",size:{width:1200,height:300},preview:"Wide rectangular banner"},{id:"banner-2",name:"Social Media Cover",type:"Banner",size:{width:820,height:312},preview:"Social cover photo"},{id:"banner-3",name:"Ad Banner",type:"Banner",size:{width:728,height:90},preview:"Thin rectangular ad"}],cards:[{id:"card-1",name:"Business Card",type:"Card",size:{width:1050,height:600},preview:"Standard business card",action:v},{id:"card-2",name:"Greeting Card",type:"Card",size:{width:1050,height:750},preview:"Foldable greeting card"},{id:"card-3",name:"Product Card",type:"Card",size:{width:600,height:800},preview:"Product display card"}],emails:[{id:"email-1",name:"Newsletter",type:"Email",size:{width:600,height:900},preview:"Newsletter template"},{id:"email-2",name:"Promotional Email",type:"Email",size:{width:600,height:800},preview:"Sales promotion email"},{id:"email-3",name:"Welcome Email",type:"Email",size:{width:600,height:700},preview:"New user welcome"}],social:[{id:"social-1",name:"Instagram Post",type:"Social",size:{width:1080,height:1080},preview:"Square image for feed"},{id:"social-2",name:"Twitter Post",type:"Social",size:{width:1200,height:675},preview:"Twitter image post"},{id:"social-3",name:"Story Format",type:"Social",size:{width:1080,height:1920},preview:"Vertical story format"}]},N=function(a){var r=a.template,n=a.icon;return t("div",{className:"border border-border/40 rounded-lg p-4 cursor-pointer hover:border-primary/70 hover:bg-accent/50 transition-all duration-300 shadow-sm hover:shadow-md",onClick:function(){return function(e){p(e.size),e.json?setTimeout((function(){g(e.json),b({title:"Template loaded",description:"".concat(e.name," template loaded successfully")})}),100):e.action&&setTimeout((function(){e.action(),b({title:"Template loaded",description:"".concat(e.name," template loaded successfully")})}),100)}(r)},children:[t("div",{className:"bg-muted/60 rounded-md h-28 mb-3 flex items-center justify-center text-muted-foreground group-hover:bg-muted/80 transition-colors overflow-hidden relative",children:[t("div",{className:"flex flex-col items-center gap-2 z-10",children:[n,t("span",{className:"text-xs font-medium",children:[r.size.width," x ",r.size.height]})]}),e("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent to-background/10 opacity-70"})]}),e("div",{className:"text-sm font-medium mb-1",children:r.name}),e("div",{className:"text-xs text-muted-foreground",children:r.type})]},r.id)},w=o("cards"),k=w[0],A=w[1];o(["nature","abstract","business","people","travel","animals","food","architecture"])[0];return t("div",{className:dt("editor-sidebar panel-transition backdrop-blur-sm bg-sidebar/95 border-r border-border/50 shadow-sm",r?"collapsed w-0":"w-[290px]"),children:[t("div",{className:"p-4 border-b border-border/30 bg-gradient-to-r from-sidebar-accent/80 to-sidebar/80 backdrop-blur-md flex justify-between items-center sticky top-0 z-10 shadow-sm",children:[e("h3",{className:"font-medium text-base bg-gradient-to-r from-sidebar-primary to-sidebar-primary/70 bg-clip-text text-transparent",children:"Design Elements"}),e(At,{variant:"ghost",size:"icon",onClick:n,className:"h-8 w-8 ml-auto text-sidebar-foreground hover:text-sidebar-primary hover:bg-sidebar-accent/50 transition-all duration-300",children:e(r?de:ue,{className:"h-4 w-4"})})]}),t(Ft,{defaultValue:"templates",value:l,onValueChange:s,className:"w-full",children:[t(Pt,{className:"w-full grid grid-cols-4 p-2 bg-sidebar-accent/30 backdrop-blur-sm sticky top-[57px] z-10 border-b border-border/20",children:[t(jt,{value:"templates",className:"text-xs data-[state=active]:bg-sidebar-primary data-[state=active]:text-sidebar-primary-foreground",children:[e(me,{className:"h-4 w-4 mr-1"}),e("span",{className:"hidden sm:inline",children:"Templates"})]}),t(jt,{value:"images",className:"text-xs data-[state=active]:bg-sidebar-primary data-[state=active]:text-sidebar-primary-foreground",children:[e(z,{className:"h-4 w-4 mr-1"}),e("span",{className:"hidden sm:inline",children:"Images"})]}),t(jt,{value:"shapes",className:"text-xs data-[state=active]:bg-sidebar-primary data-[state=active]:text-sidebar-primary-foreground",children:[e(C,{className:"h-4 w-4 mr-1"}),e("span",{className:"hidden sm:inline",children:"Shapes"})]}),t(jt,{value:"text",className:"text-xs data-[state=active]:bg-sidebar-primary data-[state=active]:text-sidebar-primary-foreground",children:[e(S,{className:"h-4 w-4 mr-1"}),e("span",{className:"hidden sm:inline",children:"Text"})]})]}),t(Rt,{className:"h-[calc(100vh-10rem)]",children:[t(Ot,{value:"templates",className:"p-4 animate-fade-in",children:[t("div",{className:"flex flex-wrap gap-2 mb-4",children:[t(At,{size:"sm",variant:"logos"===k?"default":"outline",onClick:function(){return A("logos")},className:dt("text-xs flex gap-1 items-center transition-all duration-300","logos"===k?"bg-sidebar-primary text-sidebar-primary-foreground":"hover:bg-sidebar-accent"),children:[e(ie,{className:"h-3 w-3"}),"Logos"]}),t(At,{size:"sm",variant:"banners"===k?"default":"outline",onClick:function(){return A("banners")},className:dt("text-xs flex gap-1 items-center transition-all duration-300","banners"===k?"bg-sidebar-primary text-sidebar-primary-foreground":"hover:bg-sidebar-accent"),children:[e(fe,{className:"h-3 w-3"}),"Banners"]}),t(At,{size:"sm",variant:"cards"===k?"default":"outline",onClick:function(){return A("cards")},className:dt("text-xs flex gap-1 items-center transition-all duration-300","cards"===k?"bg-sidebar-primary text-sidebar-primary-foreground":"hover:bg-sidebar-accent"),children:[e(he,{className:"h-3 w-3"}),"Cards"]}),t(At,{size:"sm",variant:"emails"===k?"default":"outline",onClick:function(){return A("emails")},className:dt("text-xs flex gap-1 items-center transition-all duration-300","emails"===k?"bg-sidebar-primary text-sidebar-primary-foreground":"hover:bg-sidebar-accent"),children:[e(pe,{className:"h-3 w-3"}),"Emails"]}),t(At,{size:"sm",variant:"social"===k?"default":"outline",onClick:function(){return A("social")},className:dt("text-xs flex gap-1 items-center transition-all duration-300","social"===k?"bg-sidebar-primary text-sidebar-primary-foreground":"hover:bg-sidebar-accent"),children:[e(z,{className:"h-3 w-3"}),"Social"]})]}),e("div",{className:"grid grid-cols-1 gap-4 mt-6",children:x[k].map((function(t){var a;switch(k){case"logos":a=e(ie,{className:"h-8 w-8 text-sidebar-primary"});break;case"banners":a=e(fe,{className:"h-8 w-8 text-sidebar-primary"});break;case"cards":a=e(he,{className:"h-8 w-8 text-sidebar-primary"});break;case"emails":a=e(pe,{className:"h-8 w-8 text-sidebar-primary"});break;case"social":a=e(z,{className:"h-8 w-8 text-sidebar-primary"});break;default:a=e(me,{className:"h-8 w-8 text-sidebar-primary"})}return e(N,{template:t,icon:a},t.id)}))})]}),e(Ot,{value:"images",className:"p-4 animate-fade-in",children:e(oa,{onImageSelect:function(e){d(e)}})}),e(Ot,{value:"shapes",className:"p-4 animate-fade-in",children:e(la,{addShape:function(e,t){switch(e){case"rect":m();break;case"circle":f();break;case"triangle":h();break;default:"function"==typeof y?y(e,t):(console.warn("addShape function not available in editor context"),"square"===e||"diamond"===e?m():"ellipse"===e?f():m())}}})}),t(Ot,{value:"text",className:"p-4 animate-fade-in",children:[e("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[{id:"q1-action",primary:"Q1",secondary:"ACTION PLAN",style:{background:"#f0f0f0",primaryColor:"#6ab04c",secondaryColor:"#2c3e50",primarySize:28,secondarySize:24,primaryFont:"Arial, sans-serif",secondaryFont:"Arial, sans-serif",primaryWeight:"bold",secondaryWeight:"bold"}},{id:"quarter-roadmap",primary:"Quarter",secondary:"ROADMAP",style:{background:"#f0f0f0",primaryColor:"#3498db",secondaryColor:"#2c3e50",primarySize:24,secondarySize:18,primaryFont:"Georgia, serif",secondaryFont:"Arial, sans-serif",primaryWeight:"normal",secondaryWeight:"bold"}},{id:"new-opportunities",primary:"NEW",secondary:"OPPORTUNITIES",style:{background:"#f0f0f0",primaryColor:"#3498db",secondaryColor:"#2c3e50",primarySize:24,secondarySize:22,primaryFont:"Arial, sans-serif",secondaryFont:"Arial, sans-serif",primaryWeight:"bold",secondaryWeight:"normal",specialStyle:"italic"}},{id:"join-team",primary:"JOIN",secondary:"OUR\nTEAM",style:{background:"#f0f0f0",primaryColor:"#2c3e50",secondaryColor:"#2c3e50",primarySize:28,secondarySize:28,primaryFont:"Times New Roman, serif",secondaryFont:"Times New Roman, serif",primaryWeight:"bold",secondaryWeight:"bold",specialStyle:"stacked"}},{id:"lets-connect",primary:"LET'S",secondary:"connect",style:{background:"#f0f0f0",primaryColor:"#3498db",secondaryColor:"#3498db",primarySize:16,secondarySize:28,primaryFont:"Arial, sans-serif",secondaryFont:"Georgia, serif",primaryWeight:"normal",secondaryWeight:"bold",specialStyle:"script"}},{id:"register-now",primary:"Register",secondary:"NOW",style:{background:"#f0f0f0",primaryColor:"#2c3e50",secondaryColor:"#ffffff",primarySize:22,secondarySize:24,primaryFont:"Arial, sans-serif",secondaryFont:"Arial, sans-serif",primaryWeight:"normal",secondaryWeight:"bold",specialStyle:"button",buttonColor:"#4CAF50"}},{id:"happening-now",primary:"Happening",secondary:"NOW",style:{background:"#f0f0f0",primaryColor:"#2c3e50",secondaryColor:"#9b59b6",primarySize:18,secondarySize:32,primaryFont:"Georgia, serif",secondaryFont:"Arial, sans-serif",primaryWeight:"normal",secondaryWeight:"bold"}},{id:"tax-season",primary:"tax",secondary:"season",style:{background:"#f0f0f0",primaryColor:"#3498db",secondaryColor:"#2c3e50",primarySize:42,secondarySize:18,primaryFont:"Georgia, serif",secondaryFont:"Georgia, serif",primaryWeight:"bold",secondaryWeight:"normal",specialStyle:"italic"}}].map((function(a){return e("div",{className:"border border-border/40 rounded-lg cursor-pointer hover:border-primary/70 hover:shadow-md transition-all duration-300 overflow-hidden group",onClick:function(){return function(e){try{if("stacked"===e.style.specialStyle){var t=e.secondary.split("\n"),a="".concat(e.primary,"\n").concat(t.join("\n"));u(a,{fontSize:e.style.primarySize,fontFamily:e.style.primaryFont,fontWeight:e.style.primaryWeight,fill:e.style.primaryColor,textAlign:"center",lineHeight:1.2})}else"button"===e.style.specialStyle?(m({width:120,height:50,rx:25,ry:25,fill:e.style.buttonColor,left:150,top:150}),u(e.secondary,{fontSize:e.style.secondarySize,fontFamily:e.style.secondaryFont,fontWeight:e.style.secondaryWeight,fill:e.style.secondaryColor,left:150,top:150,textAlign:"center",originX:"center",originY:"center"}),e.primary&&u(e.primary,{fontSize:e.style.primarySize,fontFamily:e.style.primaryFont,fontWeight:e.style.primaryWeight,fill:e.style.primaryColor,left:150,top:110,textAlign:"center",originX:"center"})):(u(e.primary,{fontSize:e.style.primarySize,fontFamily:e.style.primaryFont,fontWeight:e.style.primaryWeight,fontStyle:"italic"===e.style.specialStyle?"italic":"normal",fill:e.style.primaryColor,left:100,top:100}),u(e.secondary,{fontSize:e.style.secondarySize,fontFamily:e.style.secondaryFont,fontWeight:e.style.secondaryWeight,fontStyle:"script"===e.style.specialStyle?"italic":"normal",fill:e.style.secondaryColor,left:100,top:100+e.style.primarySize+5}));b({title:"Text template added",description:"Text template added to canvas"})}catch(e){console.error("Error adding text template:",e),b({title:"Error",description:"Failed to add text template",variant:"destructive"})}}(a)},children:t("div",{className:"flex flex-col justify-center items-center p-5 bg-muted/40 group-hover:bg-muted/70 transition-colors aspect-square relative",children:["stacked"===a.style.specialStyle?t("div",{className:"text-center",children:[e("div",{style:{color:a.style.primaryColor,fontSize:"".concat(.7*a.style.primarySize,"px"),fontFamily:a.style.primaryFont,fontWeight:a.style.primaryWeight},children:a.primary}),a.secondary.split("\n").map((function(t,r){return e("div",{style:{color:a.style.secondaryColor,fontSize:"".concat(.7*a.style.secondarySize,"px"),fontFamily:a.style.secondaryFont,fontWeight:a.style.secondaryWeight},children:t},r)}))]}):"button"===a.style.specialStyle?t("div",{className:"text-center",children:[e("div",{style:{color:a.style.primaryColor,fontSize:"".concat(.7*a.style.primarySize,"px"),fontFamily:a.style.primaryFont,fontWeight:a.style.primaryWeight,marginBottom:"5px"},children:a.primary}),e("div",{style:{backgroundColor:a.style.buttonColor,display:"inline-block",padding:"5px 15px",borderRadius:"20px"},children:e("div",{style:{color:a.style.secondaryColor,fontSize:"".concat(.7*a.style.secondarySize,"px"),fontFamily:a.style.secondaryFont,fontWeight:a.style.secondaryWeight},children:a.secondary})})]}):t("div",{className:"text-center",children:[e("div",{style:{color:a.style.primaryColor,fontSize:"".concat(.7*a.style.primarySize,"px"),fontFamily:a.style.primaryFont,fontWeight:a.style.primaryWeight,fontStyle:"italic"===a.style.specialStyle?"italic":"normal"},children:a.primary}),e("div",{style:{color:a.style.secondaryColor,fontSize:"".concat(.7*a.style.secondarySize,"px"),fontFamily:a.style.secondaryFont,fontWeight:a.style.secondaryWeight,fontStyle:"script"===a.style.specialStyle?"italic":"normal"},children:a.secondary})]}),"q1-action"===a.id||"lets-connect"===a.id||"tax-season"===a.id?e("div",{className:"absolute bottom-2 right-2 rounded-full bg-amber-500 p-1",children:e(ie,{className:"h-3 w-3 text-white"})}):null]})},a.id)}))}),t("div",{className:"mt-6",children:[e("h3",{className:"text-sm font-medium mb-3 text-sidebar-foreground border-b border-border/20 pb-2",children:"Text Styles"}),t("div",{className:"grid grid-cols-1 gap-3",children:[[{label:"Heading",fontSize:32,fontWeight:"bold",fontFamily:"Arial, sans-serif",textAlign:"left"},{label:"Subheading",fontSize:24,fontWeight:"600",fontFamily:"Arial, sans-serif",textAlign:"left"},{label:"Body",fontSize:16,fontWeight:"normal",fontFamily:"Arial, sans-serif",textAlign:"left"},{label:"Caption",fontSize:12,fontWeight:"normal",fontFamily:"Arial, sans-serif",textAlign:"left"},{label:"Quote",fontSize:20,fontWeight:"normal",fontFamily:"Georgia, serif",textAlign:"left",fontStyle:"italic"}].map((function(t,a){return e("div",{className:"border border-border/40 rounded-lg p-3 cursor-pointer hover:border-sidebar-primary/70 hover:bg-sidebar-accent/40 transition-all duration-300",onClick:function(){return u(t.label,{fontSize:t.fontSize,fontWeight:t.fontWeight,fontStyle:t.fontStyle||"normal",fontFamily:t.fontFamily,textAlign:t.textAlign||"left"})},children:e("div",{className:"overflow-hidden text-ellipsis",style:{fontSize:"".concat(t.fontSize,"px"),fontWeight:"bold"===t.fontWeight?700:"semibold"===t.fontWeight?600:(t.fontWeight,400),fontStyle:"italic"===t.fontStyle?"italic":"normal",fontFamily:t.fontFamily||"sans-serif"},children:t.label})},a)})),e(At,{variant:"outline",className:"w-full text-sm mt-2 bg-gradient-to-r from-sidebar-primary/10 to-sidebar-accent/30 hover:from-sidebar-primary/20 hover:to-sidebar-accent/40 border-border/40 transition-all duration-300",onClick:function(){return u("Custom Text")},children:"Add Custom Text"})]})]})]})]})]})]})};r.forwardRef((function(a,r){var n=a.className,i=ot(a,["className"]);return t(Ye.Root,it({ref:r,className:dt("relative flex w-full touch-none select-none items-center",n)},i,{children:[e(Ye.Track,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e(Ye.Range,{className:"absolute h-full bg-primary"})}),e(Ye.Thumb,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}))})).displayName=Ye.Root.displayName;var ca=r.forwardRef((function(a,r){var n=a.className,i=ot(a,["className"]);return t(Ye.Root,it({ref:r,className:dt("relative flex w-full touch-none select-none items-center",n)},i,{children:[e(Ye.Track,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-secondary/50",children:e(Ye.Range,{className:"absolute h-full bg-primary transition-all"})}),e(Ye.Thumb,{className:"block h-4 w-4 rounded-full border border-primary bg-background shadow-sm ring-offset-background transition-all hover:scale-110 active:scale-95 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 disabled:pointer-events-none disabled:opacity-50"})]}))}));ca.displayName="SmoothSlider";var da=x("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ua=r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e(_e.Root,it({ref:a,className:dt(da(),r)},n))}));ua.displayName=_e.Root.displayName;var ma=Qe.Root,fa=Qe.Trigger,ha=r.forwardRef((function(t,a){var r=t.className,n=t.align,i=void 0===n?"center":n,o=t.sideOffset,l=void 0===o?4:o,s=ot(t,["className","align","sideOffset"]);return e(Qe.Portal,{children:e(Qe.Content,it({ref:a,align:i,sideOffset:l,className:dt("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r)},s))})}));ha.displayName=Qe.Content.displayName;var pa=function(a){var r=a.color,n=void 0===r?"#000000":r,i=a.onChange,s=a.disableAlpha,c=void 0!==s&&s;a.showInputs;var d=o(!1),u=d[0],m=d[1],f=o(n),h=f[0],p=f[1];l((function(){p(n||"#000000")}),[n]);return t(ma,{open:u,onOpenChange:m,children:[e(fa,{asChild:!0,children:e("button",{className:"w-10 h-10 rounded border border-input overflow-hidden",style:{background:h},"aria-label":"Pick a color"})}),e(ha,{className:"w-auto p-0 border-none shadow-lg",align:"start",children:e(Ze,{color:h,onChange:function(e){var t=e.hex;p(t),i(t)},disableAlpha:c,styles:{default:{picker:{boxShadow:"none",borderRadius:"0",width:"225px"}}}})})]})},ga=r.forwardRef((function(t,a){var r=t.className,n=t.orientation,i=void 0===n?"horizontal":n,o=t.decorative,l=void 0===o||o,s=ot(t,["className","orientation","decorative"]);return e($e.Root,it({ref:a,decorative:l,orientation:i,className:dt("shrink-0 bg-border","horizontal"===i?"h-[1px] w-full":"h-full w-[1px]",r)},s))}));ga.displayName=$e.Root.displayName;var va=function(a){var r=a.collapsed,n=a.onToggle,i=Ct(),s=i.activeObject,d=i.removeActiveObject,u=i.bringForward,m=i.sendBackward,f=i.bringToFront,h=i.sendToBack,p=i.canvas,g=o("style"),v=g[0],b=g[1],x=o({}),N=x[0],w=x[1];l((function(){if(s)try{var e={};e.type=s.type,e.left=Math.round(s.left||0),e.top=Math.round(s.top||0),e.width=Math.round(s.width||0),e.height=Math.round(s.height||0),e.angle=s.angle||0,e.opacity=s.opacity||1;var t=s.fill||"#000000";if(e.fill=t,"textbox"===s.type||"text"===s.type||"i-text"===s.type){var a=s;e.text=a.text||"",e.fontSize=a.fontSize||20,e.fontFamily=a.fontFamily||"Arial",e.fontWeight=a.fontWeight||"normal",e.fontStyle=a.fontStyle||"normal",e.textAlign=a.textAlign||"left",e.charSpacing=a.charSpacing||0,e.lineHeight=a.lineHeight||1.16}else if("image"===s.type){var r=s;e.src=r.src||""}else"rect"!==s.type&&"circle"!==s.type&&"triangle"!==s.type||(e.stroke=s.stroke||"",e.strokeWidth=s.strokeWidth||0);w(e)}catch(e){console.error("Error getting object properties:",e)}else w({})}),[s]);var S=c((function(){return et((function(e,t){e&&t&&(t.renderAll(),t.fire("object:modified",{target:e}))}),50)}),[]),C=function(e,t){if(s&&p)try{w((function(a){var r;return it(it({},a),((r={})[e]=t,r))})),e in s&&(s[e]=t),"fill"===e&&s.set("fill",t),p.requestRenderAll(),S(s,p)}catch(t){console.error("Error updating property ".concat(e,":"),t),y.error("Failed to update property. Please try again.")}},k=function(a){var r=a.title,n=a.children;return t("div",{className:"space-y-3",children:[t("div",{className:"flex items-center justify-between",children:[e("h4",{className:"text-sm font-medium text-foreground",children:r}),e(ga,{className:"flex-1 mx-2"})]}),e("div",{className:"space-y-3 pl-0.5",children:n})]})};return t("div",{className:dt("editor-properties panel-transition bg-white/95 shadow-md dark:bg-gray-800/95",r?"collapsed":""),children:[t("div",{className:"flex items-center justify-between p-4 border-b border-border bg-secondary/40",children:[t("h3",{className:"font-medium text-base text-foreground flex items-center gap-2",children:[e(ge,{className:"h-4 w-4 text-muted-foreground"}),"Properties"]}),e(At,{variant:"ghost",size:"icon",onClick:n,className:"h-8 w-8 rounded-full hover:bg-secondary",children:e(r?ue:de,{className:"h-4 w-4"})})]}),s?t(Ft,{defaultValue:"style",value:v,onValueChange:b,className:"w-full",children:[t(Pt,{className:"w-full grid grid-cols-3 p-1 bg-secondary/40 border-b border-border",children:[t(jt,{value:"style",className:"text-xs rounded-md data-[state=active]:bg-white data-[state=active]:shadow-sm",children:[e(ge,{className:"h-4 w-4 mr-1"}),e("span",{children:"Style"})]}),t(jt,{value:"position",className:"text-xs rounded-md data-[state=active]:bg-white data-[state=active]:shadow-sm",children:[e(ve,{className:"h-4 w-4 mr-1"}),e("span",{children:"Position"})]}),t(jt,{value:"arrange",className:"text-xs rounded-md data-[state=active]:bg-white data-[state=active]:shadow-sm",children:[e(ye,{className:"h-4 w-4 mr-1"}),e("span",{children:"Arrange"})]})]}),t(Rt,{className:"h-[calc(100vh-180px)] overflow-y-auto",children:[t(Ot,{value:"style",className:"p-5 space-y-6 focus:outline-none",children:[e("div",{className:"flex items-center justify-center mb-4",children:t("span",{className:"px-3 py-1 bg-secondary/60 text-xs font-medium rounded-full text-muted-foreground capitalize",children:[N.type||"Unknown"," Element"]})}),e(k,{title:"Appearance",children:t("div",{className:"space-y-3",children:[t("div",{className:"space-y-2",children:[e(ua,{className:"text-xs text-muted-foreground font-medium",children:"Fill Color"}),e(pa,{color:N.fill||"#000000",onChange:function(e){C("fill",e)}})]}),t("div",{className:"space-y-2",children:[t("div",{className:"flex justify-between",children:[e(ua,{className:"text-xs text-muted-foreground font-medium",children:"Opacity"}),t("span",{className:"text-xs text-muted-foreground",children:[Math.round(100*(N.opacity||1)),"%"]})]}),e(ca,{value:[100*(N.opacity||1)],min:0,max:100,step:1,onValueChange:function(e){return C("opacity",e[0]/100)},className:"my-1"})]})]})}),("textbox"===N.type||"text"===N.type||"i-text"===N.type)&&e(k,{title:"Typography",children:t("div",{className:"space-y-3",children:[t("div",{className:"space-y-2",children:[t("div",{className:"flex justify-between",children:[e(ua,{className:"text-xs text-muted-foreground font-medium",children:"Font Size"}),t("span",{className:"text-xs text-muted-foreground",children:[N.fontSize||20,"px"]})]}),e(ca,{value:[N.fontSize||20],min:8,max:72,step:1,onValueChange:function(e){return C("fontSize",e[0])},className:"my-1"})]}),t("div",{className:"space-y-2",children:[e(ua,{className:"text-xs text-muted-foreground font-medium",children:"Font Family"}),t("select",{className:"w-full p-2 text-sm border border-input rounded-md bg-background focus:ring-1 focus:ring-ring focus:outline-none",value:N.fontFamily||"Arial",onChange:function(e){return C("fontFamily",e.target.value)},children:[e("option",{value:"Arial",children:"Arial"}),e("option",{value:"Helvetica",children:"Helvetica"}),e("option",{value:"Times New Roman",children:"Times New Roman"}),e("option",{value:"Courier New",children:"Courier New"}),e("option",{value:"Georgia",children:"Georgia"}),e("option",{value:"Verdana",children:"Verdana"}),e("option",{value:"Roboto",children:"Roboto"}),e("option",{value:"Open Sans",children:"Open Sans"}),e("option",{value:"Lato",children:"Lato"}),e("option",{value:"Montserrat",children:"Montserrat"}),e("option",{value:"Poppins",children:"Poppins"})]})]}),t("div",{className:"grid grid-cols-3 gap-2",children:[e(At,{variant:"bold"===N.fontWeight?"default":"outline",size:"sm",onClick:function(){var e="bold"===N.fontWeight?"normal":"bold";C("fontWeight",e)},className:"h-8",children:"Bold"}),e(At,{variant:"italic"===N.fontStyle?"default":"outline",size:"sm",onClick:function(){var e="italic"===N.fontStyle?"normal":"italic";C("fontStyle",e)},className:"h-8",children:"Italic"}),e(At,{variant:N.underline?"default":"outline",size:"sm",onClick:function(){var e=!N.underline;C("underline",e)},className:"h-8",children:"Underline"})]}),t("div",{className:"space-y-2",children:[e(ua,{className:"text-xs text-muted-foreground font-medium",children:"Text Align"}),e("div",{className:"grid grid-cols-4 gap-2",children:["left","center","right","justify"].map((function(t){return e(At,{variant:N.textAlign===t?"default":"outline",size:"sm",onClick:function(){return C("textAlign",t)},className:"h-8 px-0 text-xs",children:t.charAt(0).toUpperCase()+t.slice(1)},t)}))})]})]})}),("rect"===N.type||"circle"===N.type||"triangle"===N.type)&&e(k,{title:"Stroke",children:t("div",{className:"space-y-3",children:[t("div",{className:"space-y-2",children:[e(ua,{className:"text-xs text-muted-foreground font-medium",children:"Stroke Color"}),e(pa,{color:N.stroke||"#000000",onChange:function(e){C("stroke",e)}})]}),t("div",{className:"space-y-2",children:[t("div",{className:"flex justify-between",children:[e(ua,{className:"text-xs text-muted-foreground font-medium",children:"Stroke Width"}),t("span",{className:"text-xs text-muted-foreground",children:[N.strokeWidth||0,"px"]})]}),e(ca,{value:[N.strokeWidth||0],min:0,max:20,step:1,onValueChange:function(e){return C("strokeWidth",e[0])},className:"my-1"})]})]})})]}),t(Ot,{value:"position",className:"p-5 space-y-6 focus:outline-none",children:[e(k,{title:"Position & Size",children:t("div",{className:"grid grid-cols-2 gap-3",children:[t("div",{className:"space-y-2",children:[e(ua,{className:"text-xs text-muted-foreground font-medium",children:"X Position"}),t("div",{className:"flex",children:[e("input",{type:"number",className:"w-full p-2 text-sm border border-input rounded-md bg-background focus:ring-1 focus:ring-ring focus:outline-none",value:N.left||0,onChange:function(e){return C("left",Number(e.target.value))}}),e("span",{className:"ml-2 self-center text-xs text-muted-foreground",children:"px"})]})]}),t("div",{className:"space-y-2",children:[e(ua,{className:"text-xs text-muted-foreground font-medium",children:"Y Position"}),t("div",{className:"flex",children:[e("input",{type:"number",className:"w-full p-2 text-sm border border-input rounded-md bg-background focus:ring-1 focus:ring-ring focus:outline-none",value:N.top||0,onChange:function(e){return C("top",Number(e.target.value))}}),e("span",{className:"ml-2 self-center text-xs text-muted-foreground",children:"px"})]})]}),t("div",{className:"space-y-2",children:[e(ua,{className:"text-xs text-muted-foreground font-medium",children:"Width"}),t("div",{className:"flex",children:[e("input",{type:"number",className:"w-full p-2 text-sm border border-input rounded-md bg-background focus:ring-1 focus:ring-ring focus:outline-none",value:N.width||0,onChange:function(e){return C("width",Number(e.target.value))}}),e("span",{className:"ml-2 self-center text-xs text-muted-foreground",children:"px"})]})]}),t("div",{className:"space-y-2",children:[e(ua,{className:"text-xs text-muted-foreground font-medium",children:"Height"}),t("div",{className:"flex",children:[e("input",{type:"number",className:"w-full p-2 text-sm border border-input rounded-md bg-background focus:ring-1 focus:ring-ring focus:outline-none",value:N.height||0,onChange:function(e){return C("height",Number(e.target.value))}}),e("span",{className:"ml-2 self-center text-xs text-muted-foreground",children:"px"})]})]})]})}),e(k,{title:"Rotation",children:t("div",{className:"space-y-2",children:[t("div",{className:"flex justify-between",children:[e(ua,{className:"text-xs text-muted-foreground font-medium",children:"Angle"}),t("span",{className:"text-xs text-muted-foreground",children:[Math.round(N.angle||0),"Â°"]})]}),e(ca,{value:[N.angle||0],min:0,max:360,step:1,onValueChange:function(e){return C("angle",e[0])},className:"my-1"}),t("div",{className:"flex justify-between gap-2 mt-2",children:[e(At,{variant:"outline",size:"sm",className:"flex-1 h-8 text-xs",onClick:function(){return C("angle",0)},children:"Reset"}),e(At,{variant:"outline",size:"sm",className:"flex-1 h-8 text-xs",onClick:function(){return C("angle",((N.angle||0)+90)%360)},children:"+90Â°"})]})]})})]}),t(Ot,{value:"arrange",className:"p-5 space-y-6 focus:outline-none",children:[e(k,{title:"Layer Position",children:t("div",{className:"grid grid-cols-2 gap-3",children:[t(At,{variant:"outline",size:"sm",onClick:u,className:"h-9 text-xs",children:[e(ye,{className:"h-3.5 w-3.5 mr-1"}),"Bring Forward"]}),t(At,{variant:"outline",size:"sm",onClick:m,className:"h-9 text-xs",children:[e(ye,{className:"h-3.5 w-3.5 mr-1 transform rotate-180"}),"Send Backward"]}),t(At,{variant:"outline",size:"sm",onClick:f,className:"h-9 text-xs",children:[e(ye,{className:"h-3.5 w-3.5 mr-1"}),"Bring to Front"]}),t(At,{variant:"outline",size:"sm",onClick:h,className:"h-9 text-xs",children:[e(ye,{className:"h-3.5 w-3.5 mr-1 transform rotate-180"}),"Send to Back"]})]})}),e("div",{className:"pt-6 border-t border-border",children:t(At,{variant:"destructive",size:"sm",className:"w-full h-9",onClick:d,children:[e(be,{className:"h-4 w-4 mr-2"}),"Delete Element"]})})]})]})]}):t("div",{className:"p-8 text-center flex flex-col items-center justify-center h-[200px] text-muted-foreground space-y-2",children:[e(ge,{className:"h-12 w-12 text-muted-foreground/30"}),e("p",{children:"Select an element to edit its properties"})]})]})},ya=tt.Root,ba=tt.Trigger;r.forwardRef((function(a,r){var n=a.className,i=a.inset,o=a.children,l=ot(a,["className","inset","children"]);return t(tt.SubTrigger,it({ref:r,className:dt("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",i&&"pl-8",n)},l,{children:[o,e(de,{className:"ml-auto h-4 w-4"})]}))})).displayName=tt.SubTrigger.displayName,r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e(tt.SubContent,it({ref:a,className:dt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r)},n))})).displayName=tt.SubContent.displayName;var xa=r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e(tt.Portal,{children:e(tt.Content,it({ref:a,className:dt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r)},n))})}));xa.displayName=tt.Content.displayName;var Na=r.forwardRef((function(t,a){var r=t.className,n=t.inset,i=ot(t,["className","inset"]);return e(tt.Item,it({ref:a,className:dt("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n&&"pl-8",r)},i))}));Na.displayName=tt.Item.displayName,r.forwardRef((function(a,r){var n=a.className,i=a.children,o=a.checked,l=ot(a,["className","children","checked"]);return t(tt.CheckboxItem,it({ref:r,className:dt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),checked:o},l,{children:[e("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e(tt.ItemIndicator,{children:e(xe,{className:"h-4 w-4"})})}),i]}))})).displayName=tt.CheckboxItem.displayName,r.forwardRef((function(a,r){var n=a.className,i=a.children,o=ot(a,["className","children"]);return t(tt.RadioItem,it({ref:r,className:dt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n)},o,{children:[e("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e(tt.ItemIndicator,{children:e(k,{className:"h-2 w-2 fill-current"})})}),i]}))})).displayName=tt.RadioItem.displayName,r.forwardRef((function(t,a){var r=t.className,n=t.inset,i=ot(t,["className","inset"]);return e(tt.Label,it({ref:a,className:dt("px-2 py-1.5 text-sm font-semibold text-foreground",n&&"pl-8",r)},i))})).displayName=tt.Label.displayName;var wa=r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e(tt.Separator,it({ref:a,className:dt("-mx-1 my-1 h-px bg-border",r)},n))}));wa.displayName=tt.Separator.displayName;var Sa=function(t){var a=t.className,r=ot(t,["className"]);return e("span",it({className:dt("ml-auto text-xs tracking-widest text-muted-foreground",a)},r))};Sa.displayName="ContextMenuShortcut";var Ca=function(){var r=Ct(),n=r.copyToClipboard,i=r.pasteFromClipboard,o=r.pasteAtPosition,l=r.activeObject,s=r.canvas;return t(a,{children:[t(Na,{onClick:function(){return n()},children:[e(U,{className:"mr-2 h-4 w-4"}),"Copy",e(Sa,{children:"âŒ˜C"})]}),t(Na,{onClick:function(e){if(s){var t=s.getPointer(e.nativeEvent);o(t.x,t.y)}},children:[e(Ne,{className:"mr-2 h-4 w-4"}),"Paste here"]}),t(Na,{disabled:!l,onClick:function(){l&&i()},children:[e(we,{className:"mr-2 h-4 w-4"}),"Paste to replace",e(Sa,{children:"âŒ˜â‡§R"})]}),e(wa,{})]})},ka=function(){var r=Ct(),n=r.bringToFront,i=r.bringForward,o=r.sendBackward,l=r.sendToBack,s=r.activeObject;return t(a,{children:[t(Na,{onClick:function(){return n()},disabled:!s,children:[e(Se,{className:"mr-2 h-4 w-4"}),"Bring to front",e(Sa,{children:"]"})]}),t(Na,{onClick:function(){return i()},disabled:!s,children:[e(Se,{className:"mr-2 h-4 w-4"}),"Bring forward"]}),t(Na,{onClick:function(){return o()},disabled:!s,children:[e(Ce,{className:"mr-2 h-4 w-4"}),"Send backward"]}),t(Na,{onClick:function(){return l()},disabled:!s,children:[e(Ce,{className:"mr-2 h-4 w-4"}),"Send to back",e(Sa,{children:"["})]}),e(wa,{})]})},za=function(){var r=Ct(),n=r.groupSelected,i=r.ungroupSelected,o=r.activeObject;return t(a,{children:[t(Na,{onClick:function(){return n()},disabled:!o||!o.type||"activeSelection"!==o.type,children:[e(ke,{className:"mr-2 h-4 w-4"}),"Group selection",e(Sa,{children:"âŒ˜G"})]}),t(Na,{onClick:function(){return i()},disabled:!o||!o.type||"group"!==o.type,children:[e(ze,{className:"mr-2 h-4 w-4"}),"Ungroup",e(Sa,{children:"âŒ˜â‡§G"})]}),e(wa,{})]})},Aa=function(){var r=Ct(),n=r.activeObject,i=r.canvas;return t(a,{children:[t(Na,{onClick:function(){n&&i&&(n.set("selectable",!n.selectable),n.set("evented",!n.evented),i.renderAll())},disabled:!n,children:[(null==n?void 0:n.selectable)?t(a,{children:[e(Ae,{className:"mr-2 h-4 w-4"}),"Lock"]}):t(a,{children:[e(Te,{className:"mr-2 h-4 w-4"}),"Unlock"]}),e(Sa,{children:"âŒ˜L"})]}),t(Na,{onClick:function(){n&&i&&(n.set("visible",!n.visible),i.renderAll())},disabled:!n,children:[!1!==(null==n?void 0:n.visible)?t(a,{children:[e(Fe,{className:"mr-2 h-4 w-4"}),"Hide"]}):t(a,{children:[e(Pe,{className:"mr-2 h-4 w-4"}),"Show"]}),e(Sa,{children:"âŒ˜H"})]}),e(wa,{})]})},Ta=function(){var r=Ct(),n=r.activeObject,i=r.canvas,o=r.removeActiveObject;return t(a,{children:[t(Na,{onClick:function(){n&&i&&(n.set("flipX",!n.flipX),i.renderAll())},disabled:!n,children:[e(je,{className:"mr-2 h-4 w-4"}),"Flip horizontal",e(Sa,{children:"H"})]}),t(Na,{onClick:function(){n&&i&&(n.set("flipY",!n.flipY),i.renderAll())},disabled:!n,children:[e(Oe,{className:"mr-2 h-4 w-4"}),"Flip vertical",e(Sa,{children:"V"})]}),e(wa,{}),t(Na,{onClick:function(){return o()},disabled:!n,children:[e(Re,{className:"mr-2 h-4 w-4"}),"Delete",e(Sa,{children:"Delete"})]})]})},Fa=function(a){var r=a.children;return Ct().canvas,t(ya,{children:[e(ba,{className:"w-full h-full",children:r}),t(xa,{className:"w-64 bg-popover shadow-lg",children:[e(Ca,{}),e(ka,{}),e(za,{}),e(Aa,{}),e(Ta,{})]})]})},Pa=function(e){if(!e)return e;try{"text"!==e.type&&"i-text"!==e.type&&"textbox"!==e.type||(e.fontFamily||(e.set("fontFamily","Arial"),console.log("Fixed missing fontFamily in Canvas")),e.fontSize&&!isNaN(e.fontSize)||(e.set("fontSize",20),console.log("Fixed missing or invalid fontSize in Canvas")),e.fontStyle&&["","normal","italic","oblique"].includes(e.fontStyle)||(e.set("fontStyle","normal"),console.log("Fixed invalid fontStyle in Canvas")),void 0!==e.fontWeight&&null!==e.fontWeight||(e.set("fontWeight","normal"),console.log("Fixed missing fontWeight in Canvas")),void 0!==e.textAlign&&null!==e.textAlign||(e.set("textAlign","left"),console.log("Fixed missing textAlign in Canvas")),void 0===e.underline&&e.set("underline",!1),e._forceClearCache=!0),void 0!==e.fill&&null!==e.fill||(e.set("fill","#000000"),console.log("Fixed missing fill in Canvas"))}catch(e){console.error("Error in ensureValidTextProperties:",e)}return e},ja=function(e){if(!e)return e;try{void 0===e.selectable&&e.set("selectable",!0),void 0===e.hasControls&&e.set("hasControls",!0),void 0===e.hasBorders&&e.set("hasBorders",!0),void 0!==e.fill||"rect"!==e.type&&"circle"!==e.type&&"triangle"!==e.type||(e.set("fill","#000000"),console.log("Fixed missing fill in Canvas for shape"))}catch(e){console.error("Error in ensureObjectProperties:",e)}return e},Oa=function(){var a=i(null),r=i(null),n=Ct(),o=n.canvas,c=n.canvasSize,d=n.initCanvas,u=n.saveToHistory,m=n.canvasBackgroundColor,f=n.isPanEnabled;return function(){var e=Ct(),t=e.undo,a=e.redo,r=e.removeActiveObject,n=e.copyToClipboard,i=e.pasteFromClipboard,o=e.setMode,c=e.addText,d=e.addRect,u=e.addCircle,m=e.zoomIn,f=e.zoomOut,h=e.resetZoom,p=e.selectAll,g=e.clearCanvas,v=s((function(e){document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement||document.activeElement instanceof HTMLSelectElement||(!e.metaKey&&!e.ctrlKey||"z"!==e.key||e.shiftKey||(e.preventDefault(),console.log("Undo keyboard shortcut triggered"),t()),(e.metaKey||e.ctrlKey)&&"z"===e.key&&e.shiftKey&&(e.preventDefault(),console.log("Redo keyboard shortcut triggered"),a()),(e.metaKey||e.ctrlKey)&&"y"===e.key&&(e.preventDefault(),console.log("Redo keyboard shortcut triggered (Ctrl+Y)"),a()),"Delete"!==e.key&&"Backspace"!==e.key||(e.preventDefault(),r()),(e.metaKey||e.ctrlKey)&&"c"===e.key&&n(),(e.metaKey||e.ctrlKey)&&"v"===e.key&&i(),(e.metaKey||e.ctrlKey)&&"a"===e.key&&(e.preventDefault(),p()),"v"!==e.key||e.metaKey||e.ctrlKey||e.altKey||e.shiftKey||o("select"),"t"!==e.key||e.metaKey||e.ctrlKey||e.altKey||e.shiftKey||(o("text"),c("New text")),"r"!==e.key||e.metaKey||e.ctrlKey||e.altKey||e.shiftKey||(o("shape"),d()),"c"!==e.key||e.metaKey||e.ctrlKey||e.altKey||e.shiftKey||(o("shape"),u()),"d"!==e.key||e.metaKey||e.ctrlKey||e.altKey||e.shiftKey||o("draw"),"i"!==e.key||e.metaKey||e.ctrlKey||e.altKey||e.shiftKey||o("image"),"+"!==e.key&&"="!==e.key||m(),"-"!==e.key&&"_"!==e.key||f(),"0"===e.key&&h(),"Escape"===e.key&&e.shiftKey&&g())}),[t,a,r,n,i,o,c,d,u,m,f,h,p,g]);l((function(){return window.addEventListener("keydown",v),function(){window.removeEventListener("keydown",v)}}),[v])}(),l((function(){if(a.current){var e=d(a.current);e&&(e.selectionColor="rgba(65, 105, 225, 0.2)",e.selectionBorderColor="#4169e1",e.selectionLineWidth=1,e.on("before:render",(function(){try{e.getObjects().forEach((function(e){"text"!==e.type&&"i-text"!==e.type&&"textbox"!==e.type||Pa(e),ja(e)}))}catch(e){console.error("Error in before:render handler:",e)}})),e.on("mouse:down",(function(e){e.target&&("text"!==e.target.type&&"i-text"!==e.target.type&&"textbox"!==e.target.type||Pa(e.target),ja(e.target))})),e.on("object:added",(function(e){e.target&&("text"!==e.target.type&&"i-text"!==e.target.type&&"textbox"!==e.target.type||Pa(e.target),ja(e.target),console.log("Object added to canvas:",e.target.type))})),e.on("selection:created",(function(e){var t;console.log("Selection created:",null===(t=e.selected)||void 0===t?void 0:t.map((function(e){return e.type}))),e.selected&&e.selected.length>0&&e.selected.forEach((function(e){ja(e),console.log("Selected object:",e.type,"fill:",e.fill)}))})),e.on("selection:updated",(function(e){var t;console.log("Selection updated:",null===(t=e.selected)||void 0===t?void 0:t.map((function(e){return e.type}))),e.selected&&e.selected.length>0&&e.selected.forEach((function(e){ja(e),console.log("Updated selected object:",e.type,"fill:",e.fill)}))})),e.on("object:modified",(function(t){t.target&&("text"!==t.target.type&&"i-text"!==t.target.type&&"textbox"!==t.target.type||Pa(t.target),ja(t.target),console.log("Fixed properties on object:modified"),u&&u(e))})));var t=document.createElement("div");return t.style.opacity="0",t.style.position="absolute",t.style.pointerEvents="none",["Arial","Helvetica","Times New Roman","Courier New","Georgia","Verdana","Roboto","Open Sans","Playfair Display"].forEach((function(e){var a=document.createElement("span");a.style.fontFamily=e,a.innerText="Preloading Font",t.appendChild(a)})),document.body.appendChild(t),y.info("Tip: Use Ctrl+A to select all elements, then Delete to remove them all at once",{id:"canvas-tip",duration:5e3}),function(){o&&o.dispose(),document.getElementById("fontPreloader")&&document.body.removeChild(document.getElementById("fontPreloader"))}}}),[]),l((function(){o&&(o.setWidth(c.width),o.setHeight(c.height),o.renderAll())}),[o,c]),l((function(){o&&(o.backgroundColor=m,o.renderAll())}),[o,m]),t("div",{className:"editor-main",children:[e("link",{href:"https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Roboto:wght@300;400;500;700&family=Playfair+Display:wght@400;700&family=Open+Sans:wght@400;600&display=swap",rel:"stylesheet"}),e(Fa,{children:e("div",{className:"canvas-wrapper flex justify-center items-center h-full w-full",children:e("div",{ref:r,className:dt("editor-canvas-container animate-fade-in",f?"cursor-grab active:cursor-grabbing":""),style:{width:c.width,height:c.height,position:"relative",overflow:"hidden"},children:e("canvas",{ref:a,id:"fabric-canvas",className:dt("absolute top-0 left-0","touch-none select-none",f?"cursor-grab active:cursor-grabbing":"")})})})})]})},Ra=at.Root,Ea=at.Value,La=r.forwardRef((function(a,r){var n=a.className,i=a.children,o=ot(a,["className","children"]);return t(at.Trigger,it({ref:r,className:dt("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",n)},o,{children:[i,e(at.Icon,{asChild:!0,children:e(Ee,{className:"h-4 w-4 opacity-50"})})]}))}));La.displayName=at.Trigger.displayName;var Wa=r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e(at.ScrollUpButton,it({ref:a,className:dt("flex cursor-default items-center justify-center py-1",r)},n,{children:e(Le,{className:"h-4 w-4"})}))}));Wa.displayName=at.ScrollUpButton.displayName;var Ua=r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e(at.ScrollDownButton,it({ref:a,className:dt("flex cursor-default items-center justify-center py-1",r)},n,{children:e(Ee,{className:"h-4 w-4"})}))}));Ua.displayName=at.ScrollDownButton.displayName;var Da=r.forwardRef((function(a,r){var n=a.className,i=a.children,o=a.position,l=void 0===o?"popper":o,s=ot(a,["className","children","position"]);return e(at.Portal,{children:t(at.Content,it({ref:r,className:dt("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:l},s,{children:[e(Wa,{}),e(at.Viewport,{className:dt("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:i}),e(Ua,{})]}))})}));Da.displayName=at.Content.displayName,r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e(at.Label,it({ref:a,className:dt("py-1.5 pl-8 pr-2 text-sm font-semibold",r)},n))})).displayName=at.Label.displayName;var Ia=r.forwardRef((function(a,r){var n=a.className,i=a.children,o=ot(a,["className","children"]);return t(at.Item,it({ref:r,className:dt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n)},o,{children:[e("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e(at.ItemIndicator,{children:e(xe,{className:"h-4 w-4"})})}),e(at.ItemText,{children:i})]}))}));Ia.displayName=at.Item.displayName,r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e(at.Separator,it({ref:a,className:dt("-mx-1 my-1 h-px bg-muted",r)},n))})).displayName=at.Separator.displayName;var Ma=[{value:"Arial",label:"Arial"},{value:"Helvetica",label:"Helvetica"},{value:"Times New Roman",label:"Times New Roman"},{value:"Courier New",label:"Courier New"},{value:"Georgia",label:"Georgia"},{value:"Verdana",label:"Verdana"},{value:"Roboto",label:"Roboto"},{value:"Open Sans",label:"Open Sans"},{value:"Lato",label:"Lato"},{value:"Montserrat",label:"Montserrat"},{value:"Raleway",label:"Raleway"},{value:"Poppins",label:"Poppins"},{value:"Oswald",label:"Oswald"},{value:"Source Sans 3",label:"Source Sans"},{value:"Roboto Condensed",label:"Roboto Condensed"},{value:"PT Sans",label:"PT Sans"},{value:"Nunito",label:"Nunito"},{value:"Work Sans",label:"Work Sans"},{value:"Fira Sans",label:"Fira Sans"},{value:"Quicksand",label:"Quicksand"},{value:"Mulish",label:"Mulish"},{value:"Ubuntu",label:"Ubuntu"},{value:"Comfortaa",label:"Comfortaa"},{value:"Josefin Sans",label:"Josefin Sans"},{value:"Arimo",label:"Arimo"},{value:"Cabin",label:"Cabin"},{value:"Exo 2",label:"Exo 2"},{value:"PT Sans Narrow",label:"PT Sans Narrow"},{value:"Overpass",label:"Overpass"},{value:"Nanum Gothic",label:"Nanum Gothic"},{value:"Libre Franklin",label:"Libre Franklin"},{value:"Encode Sans",label:"Encode Sans"},{value:"Dosis",label:"Dosis"},{value:"Alegreya Sans",label:"Alegreya Sans"},{value:"Playfair Display",label:"Playfair Display"},{value:"Merriweather",label:"Merriweather"},{value:"Lora",label:"Lora"},{value:"PT Serif",label:"PT Serif"},{value:"Roboto Slab",label:"Roboto Slab"},{value:"Crimson Text",label:"Crimson Text"},{value:"Libre Baskerville",label:"Libre Baskerville"},{value:"Source Serif Pro",label:"Source Serif Pro"},{value:"Cormorant Garamond",label:"Cormorant Garamond"},{value:"Bitter",label:"Bitter"},{value:"Arvo",label:"Arvo"},{value:"Spectral",label:"Spectral"},{value:"Alegreya",label:"Alegreya"},{value:"Josefin Slab",label:"Josefin Slab"},{value:"Dancing Script",label:"Dancing Script"},{value:"Abril Fatface",label:"Abril Fatface"},{value:"Pacifico",label:"Pacifico"},{value:"Lobster",label:"Lobster"},{value:"Amatic SC",label:"Amatic SC"},{value:"Sacramento",label:"Sacramento"},{value:"Roboto Mono",label:"Roboto Mono"},{value:"Source Code Pro",label:"Source Code Pro"},{value:"Inconsolata",label:"Inconsolata"},{value:"Ubuntu Mono",label:"Ubuntu Mono"},{value:"Space Mono",label:"Space Mono"}],Ba=function(){var a=Ct(),r=a.activeObject,n=a.canvas,i=o(20),s=i[0],c=i[1],d=o("Arial"),u=d[0],m=d[1],f=o("left"),h=f[0],p=f[1],g=o(!1),v=g[0],y=g[1],b=o(!1),x=b[0],N=b[1],w=o(!1),S=w[0],C=w[1],k=o("#000000"),z=k[0],A=k[1],T=r&&("text"===r.type||"textbox"===r.type||"i-text"===r.type);l((function(){if(r&&T){var e=r;!function(e){e.fontFamily||(e.fontFamily="Arial",console.log("Fixed missing fontFamily in toolbar")),e.fontSize||(e.fontSize=20,console.log("Fixed missing fontSize in toolbar")),e.fontStyle&&["","normal","italic","oblique"].includes(e.fontStyle)||(e.fontStyle="normal",console.log("Fixed invalid fontStyle in toolbar")),void 0!==e.fontWeight&&null!==e.fontWeight||(e.fontWeight="normal",console.log("Fixed missing fontWeight in toolbar")),void 0!==e.textAlign&&null!==e.textAlign||(e.textAlign="left",console.log("Fixed missing textAlign in toolbar"))}(e),c(e.fontSize||20),m(e.fontFamily||"Arial"),p(e.textAlign||"left"),y("bold"===e.fontWeight),N("italic"===e.fontStyle),C(!!e.underline),A(e.fill||"#000000")}}),[r,T]);var F=function(e,t){n&&r&&T&&("fontFamily"!==e||t||(t="Arial"),"fontStyle"!==e||["","normal","italic","oblique"].includes(t)||(t="normal"),"textAlign"===e&&console.log("Setting textAlign from ".concat(r.textAlign," to ").concat(t)),r[e]=t,console.log("Updated ".concat(e," to:"),r[e]),n.renderAll(),n.fire("object:modified",{target:r}))},P=function(e){T&&(p(e),F("textAlign",e),n&&n.requestRenderAll())};return T?t("div",{className:"text-editor-toolbar bg-white border-b border-gray-200 flex items-center gap-2 z-10 p-2 overflow-x-auto",children:[e("div",{className:"text-editor-section flex-shrink-0",children:t(Ra,{value:u,onValueChange:function(e){if(T){var t=e||"Arial";m(t),F("fontFamily",t)}},children:[e(La,{className:"w-[150px] h-10",children:e(Ea,{placeholder:"Select Font"})}),e(Da,{className:"max-h-[300px]",children:Ma.map((function(t){return e(Ia,{value:t.value,style:{fontFamily:t.value},className:"text-base py-2",children:t.label},t.value)}))})]})}),e(ga,{orientation:"vertical",className:"h-8"}),t("div",{className:"text-editor-section flex-shrink-0 flex items-center border rounded-md",children:[e(At,{variant:"ghost",size:"icon",className:"h-10 rounded-r-none border-r",onClick:function(){if(T){var e=Math.max(8,s-1);c(e),F("fontSize",e)}},children:e(We,{className:"h-4 w-4"})}),e("div",{className:"px-3 flex items-center justify-center",children:e("span",{className:"text-sm font-medium",children:s})}),e(At,{variant:"ghost",size:"icon",className:"h-10 rounded-l-none border-l",onClick:function(){if(T){var e=Math.min(72,s+1);c(e),F("fontSize",e)}},children:e(V,{className:"h-4 w-4"})})]}),e(ga,{orientation:"vertical",className:"h-8"}),e("div",{className:"text-editor-section flex-shrink-0",children:e(pa,{color:z,onChange:function(e){T&&(A(e),F("fill",e))}})}),e(ga,{orientation:"vertical",className:"h-8"}),t("div",{className:"text-editor-section flex-shrink-0 flex items-center",children:[t(At,{variant:v?"default":"outline",size:"sm",onClick:function(){if(T){var e=v?"normal":"bold";y(!v),F("fontWeight",e)}},className:"h-10 font-bold px-4",children:[e(Ue,{className:"h-4 w-4 mr-1"}),"Bold"]}),t(At,{variant:x?"default":"outline",size:"sm",onClick:function(){if(T){var e=x?"normal":"italic";N(!x),F("fontStyle",e)}},className:"h-10 italic px-4 ml-1",children:[e(De,{className:"h-4 w-4 mr-1"}),"Italic"]}),t(At,{variant:S?"default":"outline",size:"sm",onClick:function(){T&&(C(!S),F("underline",!S))},className:"h-10 px-4 ml-1",children:[e(Ie,{className:"h-4 w-4 mr-1"}),"Underline"]})]}),e(ga,{orientation:"vertical",className:"h-8"}),t("div",{className:"text-editor-section flex-shrink-0 flex items-center",children:[t(At,{variant:"left"===h?"default":"outline",size:"sm",onClick:function(){return P("left")},className:"h-10 px-3 rounded-r-none",children:[e(Me,{className:"h-4 w-4 mr-1"}),"Left"]}),t(At,{variant:"center"===h?"default":"outline",size:"sm",onClick:function(){return P("center")},className:"h-10 px-3 rounded-none border-l-0 border-r-0",children:[e(Be,{className:"h-4 w-4 mr-1"}),"Center"]}),t(At,{variant:"right"===h?"default":"outline",size:"sm",onClick:function(){return P("right")},className:"h-10 px-3 rounded-l-none",children:[e(Je,{className:"h-4 w-4 mr-1"}),"Right"]})]}),t(At,{variant:"justify"===h?"default":"outline",size:"sm",onClick:function(){return P("justify")},className:"h-10 px-4 ml-1 flex-shrink-0",children:[e(He,{className:"h-4 w-4 mr-1"}),"Justify"]})]}):null},Ja=rt.Root,Ha=rt.Portal,qa=r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e(rt.Overlay,it({ref:a,className:dt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r)},n))}));qa.displayName=rt.Overlay.displayName;var Va=r.forwardRef((function(a,r){var n=a.className,i=a.children,o=ot(a,["className","children"]);return t(Ha,{children:[e(qa,{}),t(rt.Content,it({ref:r,className:dt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",n)},o,{children:[i,t(rt.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e(F,{className:"h-4 w-4"}),e("span",{className:"sr-only",children:"Close"})]})]}))]})}));Va.displayName=rt.Content.displayName;var Ka=function(t){var a=t.className,r=ot(t,["className"]);return e("div",it({className:dt("flex flex-col space-y-1.5 text-center sm:text-left",a)},r))};Ka.displayName="DialogHeader";var Ga=function(t){var a=t.className,r=ot(t,["className"]);return e("div",it({className:dt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a)},r))};Ga.displayName="DialogFooter";var Xa=r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e(rt.Title,it({ref:a,className:dt("text-lg font-semibold leading-none tracking-tight",r)},n))}));Xa.displayName=rt.Title.displayName;var Ya=r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e(rt.Description,it({ref:a,className:dt("text-sm text-muted-foreground",r)},n))}));Ya.displayName=rt.Description.displayName;var _a=function(a){var r=a.isOpen,n=a.onClose,i=a.onExport,l=o("png"),s=l[0],c=l[1],d=o("normal"),u=d[0],m=d[1],f=o(!1),h=f[0],p=f[1],g=Ct(),y=g.exportToImage,b=g.exportToHTML,x=g.downloadImage;return e(Ja,{open:r,onOpenChange:n,children:t(Va,{className:"sm:max-w-md",children:[t(Ka,{children:[e(Xa,{children:"Export Design"}),e(At,{variant:"ghost",size:"icon",className:"absolute right-4 top-4",onClick:n,children:e(F,{className:"h-4 w-4"})})]}),t(Ft,{defaultValue:"image",className:"mt-4",children:[t(Pt,{className:"grid grid-cols-2",children:[t(jt,{value:"image",children:[e(qe,{className:"h-4 w-4 mr-2"}),"Image"]}),t(jt,{value:"code",children:[e(Ve,{className:"h-4 w-4 mr-2"}),"HTML"]})]}),t(Ot,{value:"image",className:"p-4 space-y-4",children:[t("div",{className:"space-y-2",children:[e("div",{className:"text-sm font-medium",children:"Format"}),t("div",{className:"grid grid-cols-3 gap-2",children:[e(At,{variant:"png"===s?"default":"outline",size:"sm",onClick:function(){return c("png")},children:"PNG"}),e(At,{variant:"jpeg"===s?"default":"outline",size:"sm",onClick:function(){return c("jpeg")},children:"JPEG"}),e(At,{variant:"svg"===s?"default":"outline",size:"sm",onClick:function(){return c("svg")},children:"SVG"})]})]}),t("div",{className:"space-y-2",children:[e("div",{className:"text-sm font-medium",children:"Quality"}),t("div",{className:"grid grid-cols-2 gap-2",children:[e(At,{variant:"normal"===u?"default":"outline",size:"sm",onClick:function(){return m("normal")},children:"Normal"}),e(At,{variant:"high"===u?"default":"outline",size:"sm",onClick:function(){return m("high")},children:"High"})]})]})]}),t(Ot,{value:"code",className:"p-4 space-y-4",children:[t("div",{className:"space-y-2",children:[e("div",{className:"text-sm font-medium",children:"HTML Export"}),e("p",{className:"text-sm text-muted-foreground",children:"Export your design as HTML to embed directly in websites."})]}),t("div",{className:"p-4 bg-muted rounded-md",children:[e("p",{className:"text-xs text-muted-foreground",children:"The HTML output includes:"}),t("ul",{className:"list-disc list-inside text-xs text-muted-foreground mt-2",children:[e("li",{children:"SVG representation of your canvas"}),e("li",{children:"Basic styling for web display"}),e("li",{children:"No external dependencies"})]})]}),e(At,{variant:"outline",className:"w-full",onClick:function(){return c("html")},children:"Export as HTML"})]})]}),e(Ga,{className:"mt-4",children:t("div",{className:"flex space-x-2",children:[e(At,{variant:"outline",onClick:n,children:"Cancel"}),t(At,{onClick:function(){return lt(void 0,void 0,void 0,(function(){var e,t,a,r,n,o;return st(this,(function(l){switch(l.label){case 0:p(!0),l.label=1;case 1:return l.trys.push([1,6,7,8]),"html"!==s?[3,2]:(e=b(),n=new Blob([e],{type:"text/html"}),t=URL.createObjectURL(n),(a=document.createElement("a")).href=t,a.download="design.html",document.body.appendChild(a),a.click(),document.body.removeChild(a),[3,5]);case 2:return"svg"!==s?[3,4]:[4,y("svg",u)];case 3:return r=l.sent(),n=new Blob([decodeURIComponent(r.split(",")[1])],{type:"image/svg+xml"}),v(n,"design.svg"),[3,5];case 4:x(s,u),l.label=5;case 5:return i(s),[3,8];case 6:return o=l.sent(),console.error("Export failed:",o),[3,8];case 7:return p(!1),[7];case 8:return[2]}}))}))},disabled:h,children:[h?"Processing...":"Download",!h&&e(I,{className:"ml-2 h-4 w-4"})]})]})})]})})},Za=function(r){var n=r.isOpen,i=r.onClose,s=r.currentSize,c=r.onResize,d=o(s.width),u=d[0],m=d[1],f=o(s.height),h=f[0],p=f[1],g=o(!1),v=g[0],y=g[1],b=o(s.width/s.height),x=b[0],N=b[1],w=o(100),S=w[0],C=w[1],k=o(100),z=k[0],A=k[1];l((function(){n&&(m(s.width),p(s.height),N(s.width/s.height),C(100),A(100))}),[n,s]);return e(Ja,{open:n,onOpenChange:function(e){return!e&&i()},children:t(Va,{className:"sm:max-w-[500px]",children:[t(Ka,{children:[e(Xa,{children:"Resize Canvas"}),t(Ya,{children:["Adjust the dimensions of your canvas. Current size: ",s.width," Ã— ",s.height]})]}),t("div",{className:"grid gap-4 py-4",children:[t("div",{className:"grid grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[t("div",{className:"flex items-center justify-between",children:[e(ua,{htmlFor:"width",children:"Width (px)"}),t("span",{className:"text-xs text-muted-foreground",children:[S,"%"]})]}),e(qt,{id:"width",type:"number",min:"1",value:u,onChange:function(e){var t=parseInt(e.target.value)||1;if(m(t),C(Math.round(t/s.width*100)),v){var a=Math.round(t/x);p(a),A(Math.round(a/s.height*100))}}}),e(ca,{defaultValue:[100],value:[S],onValueChange:function(e){var t=e[0];C(t);var a=Math.round(s.width*t/100);if(m(a),v){var r=Math.round(a/x);p(r),A(Math.round(r/s.height*100))}},max:200,min:10,step:1})]}),t("div",{className:"space-y-2",children:[t("div",{className:"flex items-center justify-between",children:[e(ua,{htmlFor:"height",children:"Height (px)"}),t("span",{className:"text-xs text-muted-foreground",children:[z,"%"]})]}),e(qt,{id:"height",type:"number",min:"1",value:h,onChange:function(e){var t=parseInt(e.target.value)||1;if(p(t),A(Math.round(t/s.height*100)),v){var a=Math.round(t*x);m(a),C(Math.round(a/s.width*100))}}}),e(ca,{defaultValue:[100],value:[z],onValueChange:function(e){var t=e[0];A(t);var a=Math.round(s.height*t/100);if(p(a),v){var r=Math.round(a*x);m(r),C(Math.round(r/s.width*100))}},max:200,min:10,step:1})]})]}),e(At,{variant:"outline",className:"flex items-center gap-2",onClick:function(){return y(!v)},children:t(a,v?{children:[e(Ae,{className:"h-4 w-4"}),e("span",{children:"Unlock aspect ratio"})]}:{children:[e(Te,{className:"h-4 w-4"}),e("span",{children:"Lock aspect ratio"})]})}),t("div",{className:"mt-2",children:[e(ua,{className:"mb-2 block",children:"Preset Sizes"}),e("div",{className:"grid grid-cols-2 gap-2",children:[{name:"Business Card",width:850,height:500},{name:"Instagram Post",width:1080,height:1080},{name:"A4 Document",width:1e3,height:1414},{name:"Twitter Post",width:1e3,height:500},{name:"Facebook Cover",width:1080,height:608},{name:"YouTube Thumbnail",width:1280,height:720},{name:"LinkedIn Banner",width:1128,height:191},{name:"Pinterest Pin",width:1e3,height:1500}].map((function(a,r){return t(At,{variant:"outline",className:"justify-start",onClick:function(){m(a.width),p(a.height),N(a.width/a.height),C(Math.round(a.width/s.width*100)),A(Math.round(a.height/s.height*100))},children:[e("span",{className:"truncate",children:a.name}),t("span",{className:"ml-auto text-xs text-muted-foreground",children:[a.width,"Ã—",a.height]})]},r)}))})]})]}),t(Ga,{children:[e(At,{variant:"outline",onClick:i,children:"Cancel"}),e(At,{onClick:function(){c({width:u,height:h}),i()},children:"Resize"})]})]})})},Qa=function(a){var r=a.onSave,n=a.containerClassName,i=void 0===n?"":n;a.toolbarClassName;var l=a.canvasClassName,s=void 0===l?"":l,c=a.showLeftSidebar,d=void 0===c||c,u=a.showRightSidebar,m=void 0===u||u,f=o(!d),h=f[0],p=f[1],g=o(!m),v=g[0],b=g[1],x=o(!1),N=x[0],w=x[1],S=o(!1),C=S[0],k=S[1],z=o("normal"),A=z[0];z[1];var T=Ct(),F=T.activeObject,P=T.zoomIn,j=T.zoomOut,O=T.resetZoom,R=T.zoom,E=T.undo,L=T.redo,W=T.saveToJSON,U=T.downloadImage,D=T.selectAll,I=T.clearCanvas,M=T.canvasSize,B=T.setCanvasSize,J=function(){p(!h)},H=function(){b(!v)};return F&&("text"===F.type||"textbox"===F.type||F.type),t("div",{className:"design-editor flex flex-col h-screen ".concat(i),children:[e(Tt,{onExport:function(){return w(!0)},onSave:function(){var e=W();return y.success("Design saved successfully"),r&&r(e),e},onUndo:E,onRedo:L,onZoomIn:P,onZoomOut:j,onResetZoom:O,toggleLeftSidebar:J,toggleRightSidebar:H,zoom:R,onSelectAll:function(){D(),y.success("All objects selected")},onClearCanvas:function(){I(),y.success("Canvas cleared")},onResizeCanvas:function(){return k(!0)}}),e(Ba,{}),t("div",{className:"editor-workspace flex-1 flex ".concat(s),children:[d&&e(sa,{collapsed:h,onToggle:J}),e(Oa,{}),m&&e(va,{collapsed:v,onToggle:H})]}),e(_a,{isOpen:N,onClose:function(){return w(!1)},onExport:function(e){console.log("Exporting as ".concat(e," with quality ").concat(A)),w(!1),("png"===e||"jpeg"===e||"svg"===e)&&U(e,A),y.success("Design exported as ".concat(e.toUpperCase()))}}),e(Za,{isOpen:C,onClose:function(){return k(!1)},currentSize:M,onResize:function(e){B(e),y.success("Canvas resized to ".concat(e.width,"x").concat(e.height))}})]})},$a=function(t){var a=t.initialTemplate,r=t.onSave,n=t.width,i=void 0===n?800:n,o=t.height,l=void 0===o?600:o,s=t.containerClassName,c=t.toolbarClassName,d=t.canvasClassName,u=t.showLeftSidebar,m=void 0===u||u,f=t.showRightSidebar,h=void 0===f||f;return t.plugins,e(kt,{initialWidth:i,initialHeight:l,initialTemplate:a,children:e(Qa,{onSave:r,containerClassName:s,toolbarClassName:c,canvasClassName:d,showLeftSidebar:m,showRightSidebar:h})})},er=nt.Provider,tr=r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e(nt.Viewport,it({ref:a,className:dt("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",r)},n))}));tr.displayName=nt.Viewport.displayName;var ar=x("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),rr=r.forwardRef((function(t,a){var r=t.className,n=t.variant,i=ot(t,["className","variant"]);return e(nt.Root,it({ref:a,className:dt(ar({variant:n}),r)},i))}));rr.displayName=nt.Root.displayName,r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e(nt.Action,it({ref:a,className:dt("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",r)},n))})).displayName=nt.Action.displayName;var nr=r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e(nt.Close,it({ref:a,className:dt("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",r),"toast-close":""},n,{children:e(F,{className:"h-4 w-4"})}))}));nr.displayName=nt.Close.displayName;var ir=r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e(nt.Title,it({ref:a,className:dt("text-sm font-semibold",r)},n))}));ir.displayName=nt.Title.displayName;var or=r.forwardRef((function(t,a){var r=t.className,n=ot(t,["className"]);return e(nt.Description,it({ref:a,className:dt("text-sm opacity-90",r)},n))}));function lr(){var a=Ht().toasts;return t(er,{children:[a.map((function(a){var r=a.id,n=a.title,i=a.description,o=a.action,l=ot(a,["id","title","description","action"]);return t(rr,it({},l,{children:[t("div",{className:"grid gap-1",children:[n&&e(ir,{children:n}),i&&e(or,{children:i})]}),o,e(nr,{})]}),r)})),e(tr,{})]})}or.displayName=nt.Description.displayName,m.createRoot(document.getElementById("root")).render(e(n.StrictMode,{children:e((function(){return e("div",{className:"design-editor-plugin ",children:t(ut,{children:[e($a,it()),e(lr,{})]})})}),{})}));
//# sourceMappingURL=index.esm.js.map
